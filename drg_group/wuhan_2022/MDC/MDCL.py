from drg_group.wuhan_2022.Base import message,intersect,SS_VALID
from drg_group.wuhan_2022.ADRG import LA1,LB1,LC1,LD1,LE1,LF1,LJ1,LK1,LL1,LR1,LS1,LT1,LU1,LV1,LW1,LX1,LY1,LZ1

def group(record):
  mdc_zd=["N03.000","N25.001","B26.800x008+N08.0*","E72.007","A54.001","Q64.707","N36.805","N13.203","T86.104","T83.100x002","N07.500","Q63.302","T86.100x006","B87.800x001","N07.100","C67.000","N34.102","N07.200","A60.002","C68.805","D09.103","Z46.602","E11.200x212+N08.3*","N32.806","N05.701","N01.400x001","C68.803","D39.903","E11.200x027+N08.3*","N00.301","N28.830","Q62.600","N39.405","S37.001","E11.200x024+N08.3*","N39.800x001","N30.100","N25.004","Q63.301","C68.802","Q62.200","T83.100x003","Q62.602","N34.203","Q62.201","C67.600","Q54.100","N28.839","Q64.301","I72.201","T19.100","N32.807","N13.503","E11.400x381+N33.8*","N06.800","E85.411+N29.8*","E13.200x521+N08.3*","E14.200x215+N08.3*","N03.800x001","N05.900x007","N10.x02","B90.102+N29.1*","N04.903","Q54.001","N11.000x001","Q64.100","N06.900","Q64.700x801","R39.100x001","R82.900x003","S37.200x024","E10.200x011+N08.3*","Q62.100","C79.001","Q64.600","S37.300x081","N32.801","T83.800x001","N11.800x003","Q64.100x091","N23.x00","E10.200x213+N08.3*","N99.000","N31.200x002","E11.200x025+N08.3*","N20.000x001","N30.808","N02.802","Q64.200x021","Q64.708","R82.500x003","Q85.900x013","N34.205","T81.800x011","D41.001","N18.100","N99.805","N36.901","D30.100","N13.500x010","C68.900","Q64.705","N02.900x002","N14.101","T86.107","N13.600x004","Q61.400","N05.900","R82.800","T79.500","N99.806","T86.100x008","T83.100x004","N36.201","N28.102","E10.200x014+N08.3*","M31.102+N08.5*","Q62.300x101","T83.101","E10.200x017+N08.3*","Q61.500","R93.400x003","S37.300x031","N30.900","N04.001","I12.900x006","N13.506","R94.402","D36.700x025","I77.301","N28.818","N34.100","N39.404","Q62.500","N02.600","M31.703+N08.5*","A18.104+N29.1*","N02.201","N05.803","N32.104","N31.000x001","N15.102","N11.802","T81.800x014","N17.200x003","N36.809","Q64.302","Q63.800x101","N18.400","E11.200x215+N08.3*","M31.305+N08.5*","N28.825","Q62.700","N13.400","Q51.701","Q54.901","N07.700","N99.800x011","N03.400","N20.001","N02.102","N28.819","D41.901","N32.814","E10.200x030+N08.3*","T86.106","N00.600","D41.300x001","E14.200x015+N08.3*","T83.500","I12.900x008","N39.401","E11.200x028+N08.3*","N05.600","E10.200x092+N08.3*","N03.900x004","Q62.300x905","N28.826","I12.900x009","S37.200","N15.900x004","N30.801","N32.101","E11.200x017+N08.3*","E13.201+N08.3*","T83.100","R30.000x002","R32.x00","N28.833","N39.000","N03.800x004","N36.002","R39.100x002","R93.404","T83.500x003","N30.902","N35.901","N20.002","N28.823","I70.100x002","S37.300x005","S37.000x031","C67.900x002","N34.000","S37.201","B58.801+N16.0*","N99.001","Z45.800x007","M31.002+N08.5*","N17.901","A23.903+N16.0*","E14.200x011+N08.3*","C48.001","C76.301","N04.700","N18.506+I32.8*","C65.x00","B52.001+N08.0*","S37.000","T79.500x002","T86.100x001","N32.808","N39.200","N36.302","D21.506","B37.400x001+N37.0*","Z49.101","N28.822","Q62.400x002","N12.x00","Q85.900x029","R94.400","T83.001","R93.400x001","N03.200x001","E11.200x213+N08.3*","S37.300x004","N28.835","N04.102","N25.900","D18.000x819","N13.601","N07.000","N18.904","S37.003","N30.805","A36.804+N16.0*","N28.824","Q62.100x902","N02.002","N28.803","B18.904+N08.0*","N28.808","E14.200x028+N08.3*","C67.100","N01.800","N28.809","Q61.403","E11.200x029+N08.3*","N28.004","S37.211","N99.500","Q63.102","C79.100x002","N30.810","E11.200x092+N08.3*","E11.200x214+N08.3*","N28.900x004","N28.817","M35.007+N16.4*","N32.800x003","N36.807","N03.901","N11.100","C95.900x007+N16.1*","R80.x02","N25.805","N00.900x002","N14.301","T86.100x007","Q62.104","S37.310","N13.100x001","D30.701","N28.001","I12.900x002","N31.203","B18.103+N08.0*","E14.400x381+N33.8*","N20.000x003","B65.002+N22.0*","N00.902","N28.900x017","C67.200","N99.800x006","S37.302","C79.000x001","Q61.401","T86.105","Q54.000","N34.201","S37.300x021","R93.402","N28.834","N30.807","N34.000x005","Q60.200","Q64.501","E10.200x091+N08.3*","N34.001","Z52.400","R30.100","N06.001","E14.200x014+N08.3*","N13.502","E14.200x027+N08.3*","R82.901","E85.002","N99.803","E14.200x017+N08.3*","N15.101","N13.204","A18.100x025+N29.1*","Q64.704","Q64.702","R33.x00","E12.400x002+N33.8*","N21.100","N32.809","N32.100","N20.901","D41.201","E11.200x014+N08.3*","N32.811","N00.200","N31.200x001","N03.503","Q64.800x001","A18.105+N29.1*","E10.200x031+N29.8*","M35.006+N16.4*","N28.100","T86.100x005","N13.301","N00.900x008","N00.900x009","N19.x01","N04.800x002","R94.803","N19.x02","Q61.200","D41.401","N05.400","B65.001","E11.200x013+N08.3*","E11.200x091+N08.3*","E11.400x380+G99.0*","N05.802","D41.101","N36.301","D41.100x001","Q64.400x301","N36.000","C64.x00x004","N32.301","N36.001","N36.300","A54.002","N13.602","N26.x00","N28.810","C67.900","N28.003","B78.902+N08.0*","Q87.808","T83.802","Q60.501","N35.900","A02.205+N16.0*","D30.000","N20.000x002","I82.300x001","E10.200x013+N08.3*","N18.300","N20.200x001","D30.302","E14.400x380+G99.0*","I13.100x001","N27.100","N01.100x002","N36.003","B83.800x008","E10.200x025+N08.3*","N39.300x002","M32.102+N16.4*","A18.108+N33.0*","I70.101","N17.200x002","E14.200x029+N08.3*","Z46.601","I12.900x001","N25.804","Q64.303","N28.806","N13.604","N21.000","N00.901","N05.000x001","C68.804","N35.000","T83.003","Q64.900","N13.605","R82.000","I82.302","Q62.700x001","B01.800x002+N08.0*","E11.200x011+N08.3*","N03.601","N21.001","N28.801","N28.837","E72.006+N29.8*","N28.832","E11.200x211+N08.3*","Q60.100","N30.000","C68.800","E14.200x031+N29.8*","N05.900x002","Q61.901","A18.107+N29.1*","N20.000","N32.204","N32.900x002","E14.200x024+N08.3*","Z46.600x001","I12.904","N02.001","A54.100x002","E14.200x025+N08.3*","C90.005+N08.1*","K66.201","N17.101","Q61.900","E14.200x012+N08.3*","I12.000x001","C67.800","C66.x00","N21.900","Q62.300x901","R82.500x004","N32.103","N15.000","D30.200","E14.200x211+N08.3*","Q62.300x902","Q63.200","S37.200x011","E11.200x016+N08.3*","N32.002","N07.800","A56.001","T86.100x002","A18.106+N29.1*","N11.900","N07.600","Q62.400x001","Z49.201","Q62.700x201","R35.x00x001","N02.502","E12.200","T19.801","N05.900x006","S37.300x083","T83.000x001","A56.000x003","T83.103","E14.200x023+N08.3*","N13.504","Q60.400","N06.600","N28.815","I13.200x001","N32.802","N01.900x001","N28.800x001","N05.000x004","Q62.202","S37.300x082","N05.201","N39.402","N13.600x002","Q62.300x903","N28.831","Q60.500","N02.800x003","N04.601","N32.815","N04.501","N03.300x001","N32.800x008","N07.900x001","Q61.100","Q61.000","Q54.400","Q54.900","N12.x03","N28.836","N32.000","N00.800x001","N03.900","N32.200","N32.800x009","N32.201","R35.x00","Q64.700x904","R82.300","N04.300x003","Q54.800","N03.900x006","N28.802","N31.800","M10.005+N22.8*","A59.000","D18.000x806","C66.x00x002","R82.900x002","N28.900x026","N30.806","N35.000x001","E10.201+N08.3*","N05.501","R30.900x001","R39.200x001","N00.000","Q64.703","R35.x00x003","R80.x01","N01.900x002","R82.700","Q61.801","R32.x01","N01.700x001","N36.005","Q60.300","N13.300x005","S37.814","M32.101+N08.5*","N17.002","S37.303","N31.202","I12.902","N30.809","R39.000","S37.200x022","N04.400x001","T83.102","D41.301","N03.801","N34.204","N18.300x001+D63.8*","Q62.100x802","R82.500x007","D30.900","N04.900","D18.000x811","N02.801","N28.101","N02.401","N13.302","Q64.200x001","Q64.700x201","N00.400","N10.x01","N18.505+I68.8*","N20.900","I12.900x003","N00.802","N03.700","Q61.404","E10.200x012+N08.3*","E11.200x023+N08.3*","A27.900x005","M10.001+N16.8*","N01.500x001","N02.701","N32.812","N28.816","D41.400x001","N17.900x003","N32.901","S37.000x015","A59.001+N37.0*","N01.600x001","N03.900x003","N11.900x003","I12.900x005","B37.401+N37.0*","N34.200x004","Q63.001","N32.102","Q27.305","R34.x02","E10.200x211+N08.3*","N32.800x012","N13.000","D30.300","C67.400","N17.800","R34.x01","D09.101","R93.403","N28.005","D41.400x004","Q61.402","N19.x00","S37.011","Q64.403","N99.100","N06.300","N39.900","Z49.000x002","Q54.300","N13.202","N28.900x010","E14.200x016+N08.3*","Q62.601","C68.800x003","R39.801","Q63.203","C67.500","N13.501","N19.x03","Q64.700x901","N14.000","N28.901","N35.100x001","C90.004+N16.1*","N25.800x006","Q42.200x201","Q63.900","N28.813","E10.200x214+N08.3*","N28.804","N31.201","N36.004","T19.800x001","N02.203","S37.111","C66.x00x003","R82.500x006","A06.800x001","N32.800x014","C64.x00x001","N28.807","N20.900x001","N03.900x007","Q63.801","S37.200x023","N04.300x001","N04.101","N34.101","Q60.400x001","N99.100x005","R94.802","N01.900","C67.501","N03.900x002","Q64.000","N39.403","E11.200x031+N29.8*","D30.400","N03.500x003","N30.400","Q63.101","D09.104","M31.701+N08.5*","N36.100","Q63.201","Q64.401","D41.200x001","N32.804","N34.200x006","C64.x00x003","N02.101","T83.200","E10.200x029+N08.3*","N13.603","Q64.700x902","S37.300","T83.800","N02.900x001","S37.000x032","N01.300x001","N36.808","R93.401","Q64.502","N11.900x001","N05.801","N31.100x001","N03.800x003","Q64.200","S37.010","E14.200x021+N08.3*","N27.900","E14.200x213+N08.3*","N28.820","Q60.000","R80.x00","N00.100x001","N06.100","C67.700","E10.200x026+N08.3*","N04.200x001","N25.806","N28.902","N31.200x007","N31.901","N06.400","N32.803","N39.100","Q62.300x904","N36.802","B26.805+N08.0*","N03.900x005","E14.200x026+N08.3*","N14.102","T83.500x002","N34.202","C65.x02","D41.900x001","N10.x00","N14.201","N28.828","N32.300","N12.x02","N35.800","S37.000x023","T83.804","B52.000x002+N08.0*","Q52.901","N07.400","Q64.706","N05.101","N11.801","R94.401","N05.900x003","N17.000","Q60.600","Z46.603","R79.802","T83.100x001","I70.102","N36.806","N21.800","D89.101+N08.2*","E10.200x212+N08.3*","N15.900x003","R39.101","R82.600x001","N30.901","N39.400","N03.502","N20.100","C65.x01","N28.900x013","N04.902","T86.103","N32.001","N39.300","N27.000","A56.200","D09.102","N05.301","N18.501","N00.500","N17.900","E14.200x091+N08.3*","N30.300","N07.300","S37.000x022","D09.000","N06.500","Q64.701","N28.814","Q62.301","A52.709+N08.0*","N32.202","N30.201","Q64.304","N25.802","I82.301","N13.801","R30.100x001","S37.301","S37.100","Z49.000","N00.900x006","N13.901","C79.103","N01.900x003","A18.101","E10.200x016+N08.3*","E83.100x008+N16.3*","Q61.800","N00.700","N05.900x009","N18.901","N15.900x002","A43.802","N04.502","R82.902","N13.201","T86.811","B65.000x001","S37.813","I72.200x001","N26.x01","A18.103+N29.1*","N32.203","T83.801","E14.200x214+N08.3*","N17.200","R36.x01","E10.200x024+N08.3*","N17.900x004","E10.200x028+N08.3*","E14.200x092+N08.3*","R80.x00x003","N06.700","Q63.103","N28.811","Q61.300","R30.000","N30.800x004","Q62.000","M31.003+N08.5*","N26.x02","Q62.400","C79.101","E11.200x015+N08.3*","N18.200","N25.803","S37.000x013","D39.902","N18.503+G63.8*","N18.500","R82.200","Q62.800","N14.400","N31.200x006","Q62.700x101","N32.400","R31.x00","N41.300","S37.000x016","N39.800","T83.501","D18.000x855","Z46.800x001","Z49.000x004","N11.901","N11.800x002","Q63.002","T86.100x003","N01.000","Q64.400x902","E10.200x215+N08.3*","E14.200x212+N08.3*","N17.100","S37.000x012","S37.002","R93.400x002","E11.200x012+N08.3*","I72.200x003","E11.200x026+N08.3*","N28.838","Q63.000","I86.811","D09.100x001","N02.302","N03.100","A36.800x005+N33.8*","N15.801","N28.805","N28.002","N18.900x011","Q64.700x701","B52.000","C68.801","N00.801","N00.900","R39.200","S37.200x081","N39.001","N30.803","C67.300","N31.200x003","E10.200x015+N08.3*","N04.801","Q62.101","N32.810","N17.900x002","N99.101","B65.905+N08.0*","N02.900","N03.501","N06.200","N28.821","N32.800x019","D17.700x016","T19.900","C95.900x017+N16.1*","E11.201+N08.3*","Q85.903","A18.100x022+N37.8*","N30.804","E85.403","Z46.800x002","Q87.800x903","N36.200","N32.813","C68.000","D41.000x001","B18.205+N08.0*","N99.808","E10.200x027+N08.3*","Q62.103","R82.500x005","N18.500x001+D63.8*","N34.300","E10.200x023+N08.3*","N18.902","Q64.402","T83.004","R93.405","Q64.700x601","N13.600x001","B49.x18","N36.804","N05.000x003","N28.812","Q63.800x902","T19.000","S37.300x011","N34.200x003","N12.x01","N15.901","I86.201","A52.700x012+N08.0*","Q62.300x301","S37.004","N18.400x001+D63.8*","N30.802","D30.301","I77.010","E11.200x030+N08.3*","N99.100x003","N17.001","N01.200x001","N36.000x007","E66.902+N08.4*","N13.701","N02.702","N34.002","N32.805","N36.803","T86.102","Q54.200","D41.700","N02.301","N13.600","C68.100","E14.200x030+N08.3*","N18.504+H32.8*","N28.827","N25.100","S37.101","C79.102","T83.002","N28.829","N04.901","E14.200x013+N08.3*"]
  dept_list=[]
  if not (True and record.zdList[0] in mdc_zd):
    return ''
  
  message('符合MDCL入组条件，匹配规则：主诊断匹配')

  result=LA1.group(record)
  if result:
    return result
  result=LB1.group(record)
  if result:
    return result
  result=LC1.group(record)
  if result:
    return result
  result=LD1.group(record)
  if result:
    return result
  result=LE1.group(record)
  if result:
    return result
  result=LF1.group(record)
  if result:
    return result
  result=LJ1.group(record)
  if result:
    return result
  result=LK1.group(record)
  if result:
    return result
  result=LL1.group(record)
  if result:
    return result

  if False and record.ssList and intersect(SS_VALID,record.ssList):
    message('符合LQY入组条件，存在有效手术操作：'+','.join(set(record.ssList).intersection(SS_VALID)))
    return 'LQY'

  result=LR1.group(record)
  if result:
    return result

  result=LS1.group(record)
  if result:
    return result

  result=LT1.group(record)
  if result:
    return result

  result=LU1.group(record)
  if result:
    return result

  result=LV1.group(record)
  if result:
    return result

  result=LW1.group(record)
  if result:
    return result

  result=LX1.group(record)
  if result:
    return result

  result=LY1.group(record)
  if result:
    return result

  result=LZ1.group(record)
  if result:
    return result

  message('不符合MDCL的ADRG入组条件')

