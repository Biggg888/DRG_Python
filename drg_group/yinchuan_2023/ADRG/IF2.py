from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["A18.029+M01.1*","A18.800x010+M63.0*","C49.103","D16.102","D16.103","D16.900x001","D21.102","D36.700x030","D48.001","D48.100x025","D48.903+M90.7*","M10.002","M10.900x093","M10.903","M13.900","M18.101","M18.301","M18.900x002","M19.900x093","M19.903","M19.904","M20.002","M21.504","M23.400","M24.812","M25.805","M25.900x031","M65.900x093","M67.400","M79.504","M84.100x041","M84.100x042","M84.100x043","M84.100x044","M84.200","M85.600x041","M85.600x042","M86.100","M86.400","M86.602","M86.907","M87.000","M87.800x041","M89.818","M89.919","Q68.102","Q69.100","Q69.900x001","Q70.000","Q70.400x001","Q70.900x001","Q74.009","Q78.400","Q79.800x006","S61.701","S61.702","S61.901","S61.902","S62.000x001","S62.100x011","S62.100x071","S62.100x091","S62.101","S62.111","S62.200","S62.200x011","S62.200x021","S62.210","S62.300x002","S62.300x011","S62.300x021","S62.300x031","S62.300x041","S62.301","S62.310","S62.311","S62.400","S62.410","S62.500","S62.500x011","S62.500x021","S62.510","S62.600x002","S62.600x011","S62.600x021","S62.600x031","S62.611","S62.700","S62.710","S62.801","S62.802","S63.000","S63.000x042","S63.000x081","S63.100","S63.100x001","S63.100x011","S63.400x002","S63.400x006","S63.500x002","S63.500x101","S63.601","S66.300x003","S66.300x007","S66.300x008","S66.300x009","S68.001","S68.100x001","S68.200x001","S68.201","S68.300","S69.700","S83.500x012","S83.700x003","S92.300x003","S92.500x001","T14.210"]
  adrg_zd1=[]
  adrg_ss=["77.0401","77.0902","77.2900x003","77.3906","77.6401","77.6402","77.6902","77.7400","77.8400x001","78.0401","78.0402","78.0403","78.0902","78.1902","78.4402","78.4902","78.5400x003","78.5400x005","78.5400x006","78.5400x009","78.5400x010","78.5402","78.5900x019","78.5900x031","78.5902","79.0400x004","79.0401","79.1300x004","79.1300x005","79.1300x006","79.1300x007","79.1300x008","79.1300x009","79.1302","79.1400x002","79.1400x003","79.2302","79.2401","79.3300x005","79.3300x006","79.3300x007","79.3300x008","79.3300x010","79.3300x012","79.3300x013","79.3301","79.3302","79.3400x002","79.3400x003","79.3400x004","79.3400x005","79.3400x006","79.3401","79.6302","79.6400","79.7402","79.8300x001","79.8301","79.8401","79.8402","79.8900x005","80.1300x002","80.4400x001","80.4401","80.7300","80.7301","80.7400","80.8301","80.8401","81.2500x002","81.2500x003","81.2500x004","81.2601","81.2701","81.2801","81.7100x003","81.7200x002","81.7200x003","81.7200x006","81.7500x002","81.7500x003","81.7500x004","81.7500x005","81.7900","81.9300x003","81.9300x005","81.9300x007","81.9300x008","82.0902","82.3900x001","82.6100x002","82.7100x001","82.7101","82.8900x003","84.0100x001","84.0100x002","84.0100x004","84.0102","84.0201","84.0202","84.2101","84.2201","86.8501"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IF2入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IF23_group(record):
      return 'IF23'

    if MDCI_DRG.IF25_group(record):
      return 'IF25'

    return 'IF2'
  else:
    return ''

