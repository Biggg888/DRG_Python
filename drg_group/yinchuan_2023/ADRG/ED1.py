from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCE_DRG

def group(record):
  adrg_zd=["A15.000x001","A15.000x010","A15.000x016","A15.000x024","A15.000x026","A15.007","A15.100x001","A15.100x002","A15.100x006","A15.107","A15.201","A15.307","A15.500x003","A15.508","A15.601","A15.602","A15.605","A16.007","A16.008","A16.009","A16.037","A16.108","A16.200x002","A16.200x015","A16.207","A16.402","A16.500x004","A16.500x008","A16.500x010","A16.501","A16.505","A19.000x011","A19.801","A19.802","B44.102+J17.2*","B45.000","C34.000x002","C34.000x003","C34.001","C34.100x003","C34.100x004","C34.201","C34.300x003","C34.300x004","C34.301","C34.803","C34.900x001","C34.900x004","C34.900x005","C34.900x006","C34.900x008","C34.901","C37.x00","C45.000","C76.100x003","C77.103","C78.000","C78.200","C78.201","D02.200x002","D38.101","I26.900x001","I26.900x010","I26.900x015","I89.807","J13.x00","J15.000","J15.000x002","J15.600x005","J15.700","J15.900","J15.902","J15.903","J18.000","J18.100","J18.200","J18.803","J18.903","J20.900","J21.900","J22.x00","J39.805","J39.806","J39.810","J42.x00","J42.x00x004","J43.902","J44.000","J44.100","J44.802","J44.900x004","J45.005","J45.900x021","J47.x01","J47.x03","J82.x01","J84.101","J84.104","J84.800x004","J84.800x005","J84.900","J85.100","J86.000","J86.017","J86.902","J86.903","J90.x00","J90.x00x002","J90.x00x003","J93.100x001","J93.100x002","J93.900","J94.201","J94.801","J94.802","J94.804","J95.804","J96.000","J96.900x001","J96.900x003","J98.005","J98.006","J98.101","J98.400x016","J98.410","J98.414","J98.700","M34.801+J99.1*","M35.002+J99.1*","R04.200","R09.100","R59.009","R91.x00x001","R91.x03","S27.000","S27.100","S27.200","S27.301","S27.808","S29.700","S29.900","T17.400","T17.500","T17.900"]
  adrg_zd1=[]
  adrg_ss=["30.0901","30.0911","32.0100x004","32.0101","32.0102","33.2400x001","33.2400x002","33.2405","33.2700x001","33.2702","33.2703","33.2900","33.3201","33.9301","33.9900x001","33.9903","34.0103","34.0401","34.0402","34.0903","34.9101","34.9102","34.9103","34.9104","34.9201","34.9202","40.1100x012","40.2901","40.2904","40.5914","98.1503","98.1504"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合ED1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCE_DRG.ED11_group(record):
      return 'ED11'

    if MDCE_DRG.ED13_group(record):
      return 'ED13'

    if MDCE_DRG.ED15_group(record):
      return 'ED15'

    return 'ED1'
  else:
    return ''

