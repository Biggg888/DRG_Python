from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["A18.032+M49.0*","A18.034+M01.1*","A18.037+M01.1*","A52.103+M14.6*","M06.900","M10.002","M10.900x093","M12.500","M12.500x021","M12.500x061","M12.500x071","M13.100","M13.900","M15.301","M17.000","M17.101","M17.900","M17.900x003","M17.900x004","M19.101","M19.900x095","M19.900x096","M19.900x097","M19.901","M19.905","M20.100x001","M20.100x002","M20.200x001","M21.002","M21.003","M21.105","M21.302","M21.400","M21.504","M21.505","M21.601","M22.000","M22.100","M22.200x001","M22.300x001","M23.001","M23.100","M23.205","M23.206","M23.210","M23.213","M23.301","M23.302","M23.303","M23.304","M23.306","M23.308","M23.400","M23.800x011","M23.800x021","M23.800x094","M24.202","M24.309","M24.311","M24.401","M24.800x052","M24.906","M25.301","M25.603","M25.803","M65.906","M65.909","M67.001","M67.901","M75.000","M75.000x001","M75.100","M75.101","M75.103","M75.201","M75.300","M75.302","M75.400","M75.600","M76.800x072","M76.806","M77.400","M77.800x001","M77.800x002","M77.900","M85.600x071","M87.200x073","M87.800x101","M87.900x071","M89.823","M92.701","M93.200x001","M93.202","Q66.000","Q66.600","Q66.601","Q66.700","Q66.800x008","S42.100x042","S42.300","S42.402","S42.403","S42.404","S43.000","S43.000x011","S43.100","S43.400x005","S46.000x001","S46.002","S46.800x002","S46.800x003","S46.801","S52.000x021","S52.001","S52.100x001","S53.100","S53.300x001","S76.000x003","S76.100x004","S76.102","S79.800","S82.000","S82.000x002","S82.100x085","S82.100x087","S82.101","S82.400x001","S82.501","S82.510","S82.600","S83.000","S83.001","S83.100","S83.200x001","S83.200x002","S83.200x003","S83.200x005","S83.200x006","S83.201","S83.202","S83.400x001","S83.400x002","S83.400x003","S83.400x012","S83.400x022","S83.400x041","S83.400x042","S83.500x001","S83.500x002","S83.500x003","S83.500x011","S83.500x012","S83.500x022","S83.500x031","S83.500x032","S83.500x041","S83.500x042","S83.501","S83.600x002","S83.601","S83.700x001","S83.700x002","S83.700x003","S83.700x005","S83.700x006","S91.301","S92.000","S93.102","S93.103","S93.200x001","S93.200x002","S93.200x003","S93.200x004","S93.200x005","S93.300x031","S93.400","S93.400x002","S93.400x012","S93.400x022","S93.401","S93.403","S93.500x002","S93.500x003","S93.500x004","T13.200x006","T13.200x009","Z47.001"]
  adrg_zd1=[]
  adrg_ss=["77.2800x002","77.2802","77.2900x006","81.1100","81.1100x003","81.1101","81.1200x001","81.1300x003","81.1500","81.1500x001","81.1600","81.1800","81.2201","81.2300x002","81.2300x004","81.2901","81.4000x004","81.4000x005","81.4501","81.4502","81.4503","81.4504","81.4505","81.4600x001","81.4601","81.4700x001","81.4700x005","81.4700x013","81.4700x015","81.4700x017","81.4900x001","81.4900x002","81.4900x003","81.4901","81.4902","81.8201","81.8300x001","81.8300x003","81.8300x004","81.8300x006","81.8300x007","81.8300x008","81.8300x009","81.8301","81.8302","81.8303","81.8305","81.8500x001","81.8500x002","81.9300x010","81.9400x001","81.9400x006","81.9400x007","81.9402","81.9403","81.9404","81.9500x001","81.9501","81.9502","81.9600x003","81.9600x009","81.9600x015","81.9600x017","81.9600x020","81.9600x022","81.9600x023","81.9600x024","81.9600x026","81.9600x027","81.9600x030","81.9600x031","81.9600x032"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IC3入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IC39_group(record):
      return 'IC39'

    return 'IC3'
  else:
    return ''

