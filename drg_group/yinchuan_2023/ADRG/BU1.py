from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCB_DRG

def group(record):
  adrg_zd=["C47.200x001","C47.600","C47.600x003","C70.000","C71.000x004","C71.002","C71.003","C71.100","C71.200","C71.300","C71.400","C71.500","C71.500x004","C71.600","C71.601","C71.700","C71.800","C71.800x006","C71.800x007","C71.801","C71.802","C71.803","C71.804","C71.805","C71.806","C71.808","C71.900","C71.900x002","C71.900x006","C72.000","C72.001","C72.500","C72.506","C72.900x004","C75.200","C79.300","C79.300x002","C79.300x011","C79.300x016","C79.301","C79.302","C79.304","C79.306","C79.309","C79.400x013","D17.700x009","D17.700x013","D32.000","D32.000x004","D32.000x014","D32.000x021","D32.000x024","D32.000x026","D32.000x028","D32.000x032","D32.000x039","D32.001","D32.002","D32.004","D32.005","D32.006","D32.007","D32.011","D32.015","D32.017","D32.018","D32.019","D32.020","D32.100","D32.100x001","D32.102","D32.103","D32.106","D32.900x002","D33.001","D33.003","D33.004","D33.005","D33.007","D33.101","D33.104","D33.105","D33.200x001","D33.300","D33.305","D33.308","D33.310","D33.400","D33.401","D33.402","D33.403","D33.900x003","D33.902","D35.201","D35.300","D35.500","D36.100x002","D36.100x008","D36.100x010","D36.100x012","D36.100x014","D36.100x015","D36.100x016","D36.100x017","D36.100x024","D36.100x026","D36.100x030","D36.100x033","D36.100x037","D36.100x057","D36.100x058","D36.102","D36.106","D36.107","D36.109","D36.112","D36.114","D36.115","D36.116","D43.007","D43.013","D43.103","D43.105","D43.200x004","D43.201","D43.300x008","D43.301","D43.401","D44.400x001","D44.401","D48.200x044","D48.204","D48.210","D48.905+G13.1*","D48.907+G13.0*","R90.000","R90.806"]
  adrg_zd1=[]
  adrg_ss=[]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd:
    message('符合BU1入组条件，匹配规则：主诊断匹配')
    
    if MDCB_DRG.BU11_group(record):
      return 'BU11'

    if MDCB_DRG.BU13_group(record):
      return 'BU13'

    if MDCB_DRG.BU15_group(record):
      return 'BU15'

    return 'BU1'
  else:
    return ''

