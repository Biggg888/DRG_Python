from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCB_DRG

def group(record):
  adrg_zd=["B02.202+G53.0*","C71.500x003","C71.900","D36.100x002","D36.100x005","D36.100x017","D36.100x024","D36.100x032","D36.100x033","D36.102","D36.111","D36.114","D36.116","E11.401+G63.2*","G20.x03","G43.900","G44.000x002","G44.004","G50.000","G50.003","G50.100","G50.900","G51.301","G51.900","G52.800x004","G54.002","G54.801","G54.900x001","G56.000","G56.100","G56.100x002","G56.100x004","G56.200","G56.201","G56.202","G56.203","G57.000x003","G57.300x005","G57.500","G57.500x001","G57.603","G57.800x001","G58.001","G58.801","G62.901","G80.100","G81.000","G81.100","G82.200","G90.600","G93.501","G95.003","I61.004","I61.006","I61.100x005","I61.500x007","I61.802","I62.900x001","I63.200","I63.502","I63.801","I63.902","I63.905","I69.100x002","M79.207","S02.002","S14.300","S44.000x001","S44.200x001","S54.000x001","S54.001","S54.100x001","S54.101","S54.200x001","S64.000x001","S64.000x002","S64.100x001","S64.100x002","S64.200x001","S64.300","S64.400x001","S64.700x001","S74.000x001","S84.000x001","S84.100x001","S84.800x001","S84.800x002","S84.900x001","S94.700x001","S94.800x001"]
  adrg_zd1=[]
  adrg_ss=["01.0200x001","01.0900x002","01.0900x006","01.0901","01.2502","04.0200x007","04.0200x008","04.0309","04.0414","04.0418","04.0419","04.0425","04.0426","04.0700x045","04.0700x048","04.0713","04.0714","04.0715","04.0717","04.0719","04.0720","04.2x01","04.2x02","04.2x03","04.2x11","04.3x00x017","04.3x00x021","04.3x00x024","04.3x10","04.3x11","04.3x12","04.3x13","04.3x17","04.3x18","04.4300","04.4301","04.4900x037","04.4900x042","04.4900x047","04.4901","04.4902","04.4903","04.4907","04.4908","04.4915","04.4917","04.5x05","04.5x09","04.6x00x013","04.6x00x014","04.6x08","04.6x10","04.7407","04.7408","04.7409","04.7410","04.7412","04.7417","04.7418","04.7503","04.8100x003","04.8101","04.8102","04.8104","04.8106","05.2100x002","05.3100","05.3100x006","86.5902","92.3101"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合BJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCB_DRG.BJ11_group(record):
      return 'BJ11'

    if MDCB_DRG.BJ13_group(record):
      return 'BJ13'

    if MDCB_DRG.BJ15_group(record):
      return 'BJ15'

    return 'BJ1'
  else:
    return ''

