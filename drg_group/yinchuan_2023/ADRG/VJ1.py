from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCV_DRG

def group(record):
  adrg_zd=["S21.200x001","S21.700","S31.100","S31.102","S31.800x031","S39.903","S39.907","S41.100","S49.900x001","S51.000","S51.700","S51.800x011","S61.000x001","S61.000x002","S61.100x001","S61.100x002","S61.700","S61.800x011","S61.800x012","S61.800x081","S61.900","S61.900x002","S67.000x001","S67.001","S67.800x003","S67.801","S68.000x002","S68.100x002","S68.400x001","S68.800x001","S69.900x001","S69.900x002","S69.900x003","S69.900x004","S71.100","S81.000","S81.700","S81.800x011","S81.900","S87.801","S88.100x001","S91.000","S91.200","S91.300x002","S91.300x813","S91.700x002","S91.700x003","S97.801","S98.100x001","S98.200x002","S99.700x001","S99.900x001","S99.900x002","T01.200x001","T01.600x001","T02.400x001","T02.600x001","T11.100","T11.600","T13.100","T39.201","T39.901","T42.101","T42.400","T42.401","T42.403","T42.406","T42.600x002","T42.600x004","T42.800x001","T43.201","T44.300","T44.701","T46.900x001","T50.900","T50.900x001","T58.x00","T60.000x004","T60.001","T60.002","T60.101","T60.300x001","T60.401","T60.900x002","T62.000x001","T62.001","T62.900x002","T67.000x001","T78.200","T81.000x014","T81.006","T81.011","T81.015","T81.019","T81.022","T81.024","T81.026","T81.205","T81.208","T81.301","T81.400x011","T81.400x012","T81.400x013","T81.407","T81.408","T81.409","T81.500x001","T81.501","T81.504","T81.800x001","T81.800x017","T81.808","T81.810","T81.811","T81.813","T85.500x001","T85.600","T85.610","T88.101"]
  adrg_zd1=[]
  adrg_ss=["03.3101","04.0408","04.0414","04.3x00x017","04.3x00x024","04.3x05","04.3x09","04.3x10","04.3x11","04.3x12","04.3x13","04.7408","04.7409","04.7410","04.7412","04.7418","17.972E0","34.0401","34.4x01","34.7101","34.9101","38.6000x010","38.7x04","38.9501","38.9700x002","38.9900x501","38.9900x901","39.2700x001","39.3100","39.3100x004","39.3100x007","39.3100x010","39.3101","39.3112","39.3113","39.3200","39.3200x006","39.3202","39.4902","39.5900x001","39.5900x024","39.7900x019","39.9500","39.9500x005","39.9500x007","39.9600x003","39.9801","44.4300x002","44.6100x003","45.4304","45.4307","45.7600x008","45.9403","46.5200x010","47.0901","50.0x01","50.6101","51.1000","51.8503","51.8600x002","51.8700x003","54.0x00x004","54.0x00x010","54.0x02","54.0x03","54.1100","54.1900x005","54.1900x010","54.2100","54.3x00x004","54.3x00x011","54.3x01","54.5901","54.5904","54.6101","54.6301","54.7400x005","54.7402","54.9101","54.9202","57.0x00x006","60.2901","60.9401","68.2913","69.4903","69.7x00","71.7102","74.1x01","77.2800x002","77.2900x003","77.6802","77.8106","77.8903","78.0902","78.1701","78.4105","78.5300x002","78.5300x006","78.5400x006","78.5900x031","78.5900x034","78.6303","78.6705","78.6803","79.0100x001","79.0201","79.0401","79.1200x004","79.1300x004","79.1400x002","79.1400x003","79.1700x005","79.1800x002","79.2401","79.3100x004","79.3100x005","79.3200x001","79.3200x009","79.3200x011","79.3200x012","79.3300x008","79.3400x002","79.3400x004","79.3401","79.3600x010","79.3700x015","79.3700x017","79.3700x020","79.3702","79.3900x001","79.6000","79.7401","79.8801","79.8900x001","80.4201","80.7600","80.8102","80.8601","81.2801","81.8300x008","81.9300x007","81.9300x008","81.9300x010","81.9301","81.9302","81.9403","81.9600x003","81.9600x015","82.0201","82.0902","82.3601","82.4400x001","82.4400x002","82.4500x001","82.4500x012","82.4500x013","82.4501","82.4601","82.4602","82.5301","82.8500x001","82.8600x006","82.9100x004","83.0100x001","83.0200x005","83.0200x006","83.0900x003","83.0903","83.0904","83.1301","83.2900x001","83.2900x002","83.2900x003","83.3200x001","83.3900x017","83.6400x007","83.6400x008","83.6400x009","83.6400x011","83.6400x013","83.6401","83.6402","83.6500x002","83.6500x003","83.6500x005","83.6500x006","83.6500x012","83.6500x016","83.6501","83.6502","83.7700x001","83.8202","83.8800x016","83.8802","83.8803","84.0100x004","84.0102","84.0201","84.0302","84.1501","84.2101","84.2201","84.2303","84.2401","84.3x00","84.5501","85.9100","85.9400","86.0100x002","86.0400x011","86.0401","86.0500x007","86.0502","86.0900x002","86.0902","86.2300x005","86.3x03","86.5900x006","86.5901","86.700x0013","86.700x0014","86.8600x001","86.8900x011","86.8901","86.9100x002","86.9900","98.2800x001","98.2900x001"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合VJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCV_DRG.VJ11_group(record):
      return 'VJ11'

    if MDCV_DRG.VJ13_group(record):
      return 'VJ13'

    if MDCV_DRG.VJ15_group(record):
      return 'VJ15'

    return 'VJ1'
  else:
    return ''

