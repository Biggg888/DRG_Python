from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCD_DRG

def group(record):
  adrg_zd=["A18.200x002","A18.205","C03.100","C06.000","C06.001","C11.900","C44.300","C44.304","C76.003","C77.002","D10.000","D10.100","D10.300x005","D10.300x007","D10.302","D10.303","D10.306","D10.900","D11.000","D11.701","D16.411","D16.500","D17.001","D17.002","D17.700x021","D18.000x505","D18.000x809","D18.003","D18.100x027","D18.102","D21.001","D22.301","D23.200x008","D23.300x003","D23.300x004","D23.301","D36.700x005","D36.702","D36.703","D37.007","D37.009","D48.700x025","G47.300x037","H81.901","I88.900x004","J05.100","J30.400","J35.100","J35.200","J38.102","J38.715","J39.003","J39.200x016","J39.215","K00.100x001","K00.608","K01.000","K01.100","K03.800x003","K04.500","K04.600","K04.700","K04.701","K04.800","K04.801","K05.200","K05.202","K05.300","K05.600","K06.803","K06.807","K06.808","K06.809","K08.104","K08.202","K08.300x002","K08.302","K08.802","K08.805","K09.004","K09.204","K09.205","K09.804","K09.805","K09.806","K09.808","K10.002","K10.100x003","K10.901","K11.200x009","K11.204","K11.600x005","K11.603","K11.903","K12.117","K12.200x011","K12.200x018","K12.202","K12.204","K12.205","K12.210","K12.216","K12.217","K13.000x014","K13.006","K13.010","K13.200x010","K13.200x011","K13.401","K13.600","K13.603","K13.700x026","K13.702","K14.002","K14.003","K14.800x012","K14.805","K14.901","L02.000","L04.001","Q18.001","Q18.002","Q36.902","Q38.100","Q38.500x005","Q38.600x006","Q89.202","S01.504","S01.506","S01.802","S01.803","S08.000"]
  adrg_zd1=[]
  adrg_ss=["04.0205","04.0401","04.0404","04.4203","06.7x00","06.7x01","06.7x02","23.0100","23.0900x003","23.1100","23.1900x003","23.1900x006","23.1900x007","23.1902","23.7300","23.7300x001","23.7301","24.2x00","24.3100x003","24.3200x001","24.3900x002","24.4x00x002","24.4x01","24.4x04","24.4x06","24.5x00x003","24.5x01","24.5x02","24.5x04","24.5x05","24.6x01","25.1x01","25.1x04","25.1x05","25.5900x008","25.9100x001","25.9900x001","27.0x01","27.0x03","27.0x05","27.0x06","27.0x08","27.0x10","27.3101","27.3200x001","27.3201","27.3202","27.4200","27.4300x011","27.4301","27.4900x007","27.4901","27.4902","27.4904","27.4905","27.4906","27.5100","27.5702","27.5903","27.7201","27.7901","27.9900x005","27.9901","27.9902","29.9900","33.2400x002","33.2405","40.2100","40.2900x008","40.2900x021","40.2910","40.3x00x001","40.3x00x002","40.3x00x005","40.4000x003","40.5901","40.9x00x016","86.2200x011","86.2800x012","86.7407","86.8900x002","86.9301"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合DJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCD_DRG.DJ13_group(record):
      return 'DJ13'

    if MDCD_DRG.DJ15_group(record):
      return 'DJ15'

    return 'DJ1'
  else:
    return ''

