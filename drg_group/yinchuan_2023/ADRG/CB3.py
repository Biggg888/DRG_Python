from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCC_DRG

def group(record):
  adrg_zd=["E11.301+H36.0*","E11.302+H28.0*","E14.300x061+H28.0*","E88.906+H28.1*","H04.401","H11.000","H16.000","H16.802","H18.808","H20.101","H20.900x004","H21.505","H25.000","H25.000x002","H25.000x003","H25.000x006","H25.000x007","H25.001","H25.002","H25.004","H25.100","H25.200","H25.800","H25.900","H26.000x005","H26.100","H26.200","H26.202","H26.300","H26.300x001","H26.400","H26.801","H26.900","H26.901","H27.000","H27.100","H27.101","H27.102","H27.800","H31.400","H33.000x006","H33.000x007","H33.001","H33.200x002","H33.500","H33.500x008","H33.502","H33.503","H33.504","H33.506","H34.801","H35.300x011","H35.303","H35.305","H35.306","H35.600","H35.804","H40.000x004","H40.100","H40.100x001","H40.200","H40.200x006","H40.200x007","H40.202","H40.203","H40.400","H40.500","H40.500x002","H40.500x009","H40.501","H40.503","H40.504","H40.505","H40.801","H40.900","H43.100","H43.300","H43.800x003","H43.802","H43.805","H43.900","H44.000x005","H44.400","H52.701","Q12.000","Q12.200","Q14.003","S05.100x004","T85.200x001","T85.200x002","T85.201","T85.202","T85.311","T85.800x807","Z48.801"]
  adrg_zd1=[]
  adrg_ss=["13.1900x006","13.1900x007","13.1902","13.4100x001","13.4101","13.4200x001","13.4300x001","13.5900x001","13.6500x002","13.6501","13.6502","13.6503","13.6900x002","13.6901","13.7000","13.7100x001","13.7200x001","13.8x00x003","13.9000x004","13.9000x005","13.9000x007","13.9000x008","13.9000x009","13.9000x011","13.9001","13.9002","13.9003"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合CB3入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCC_DRG.CB39_group(record):
      return 'CB39'

    return 'CB3'
  else:
    return ''

