from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["A18.000x053+M01.1*","A18.007+M49.0*","A18.027+M01.1*","A18.028+M01.1*","A18.031+M01.1*","A18.032+M49.0*","A18.034+M01.1*","A18.035+M01.1*","A18.036+M01.1*","A23.901+M49.1*","C40.200x005","C41.400x008","C41.901","D16.002","D16.100x005","D16.200x005","D16.201","D16.202","D16.900x003","D18.000x860","D21.200","D21.200x003","D21.200x006","D21.900x012","D48.020","D48.100x006","D48.131","D48.133","M00.900","M00.900x011","M00.900x021","M00.900x061","M00.900x071","M06.900","M06.906","M10.002","M10.900x093","M10.903","M12.200x051","M12.200x061","M12.200x071","M12.500x021","M12.500x071","M13.100","M17.000","M17.101","M17.200","M17.301","M17.900","M17.900x003","M17.900x004","M19.901","M19.902","M19.905","M21.104","M21.604","M21.806","M22.000","M22.200x001","M22.201","M22.301","M23.000x031","M23.000x061","M23.001","M23.100","M23.210","M23.213","M23.301","M23.303","M23.305","M23.306","M23.308","M23.400","M23.800x011","M23.809","M23.810","M23.811","M23.900","M24.001","M24.002","M24.006","M24.202","M24.401","M24.409","M24.502","M24.800x052","M24.802","M24.906","M25.501","M25.506","M25.603","M25.607","M25.804","M25.807","M25.808","M25.900x061","M51.202","M62.405","M65.800x093","M65.900x062","M65.901","M65.906","M65.907","M65.909","M67.402","M67.800x094","M67.800x096","M67.804","M70.400","M71.200","M71.200x001","M71.302","M71.307","M71.310","M72.408","M75.000","M75.000x001","M75.001","M75.103","M75.300","M75.400","M76.800x072","M77.300","M84.000x061","M86.912","M86.913","M87.200x042","M87.800x051","M89.309","M89.903","M93.200x001","M93.202","Q65.000","Q65.100","Q74.101","Q78.400x002","Q78.405","S43.000","S43.100","S46.002","S46.800x006","S46.801","S52.000x001","S52.001","S52.101","S52.200x011","S52.801","S53.000","S82.000","S82.000x002","S82.010","S82.100x085","S83.000","S83.001","S83.200x001","S83.200x002","S83.200x004","S83.200x005","S83.200x006","S83.201","S83.202","S83.300x001","S83.400x002","S83.400x022","S83.500x001","S83.500x002","S83.500x003","S83.500x012","S83.500x032","S83.600x002","S83.700x002","S83.700x003","S83.700x005","S83.700x006","S92.100","S93.000","S93.400x002","S93.400x032","S93.601","T13.001","T84.500x002","T84.502","T84.600x003","T84.807","Z47.001"]
  adrg_zd1=[]
  adrg_ss=["77.2700x001","77.2700x003","77.2701","77.2702","77.2703","77.6601","77.8300x005","77.8300x006","77.8302","78.0600x001","78.4600x002","78.4600x003","79.6900x002","79.7100","79.7200","79.7500","79.7600x001","79.8100x003","79.8201","79.8500x001","79.8700","80.0500x001","80.0600x001","80.0601","80.1100","80.1101","80.1200","80.1200x002","80.1201","80.1500x001","80.1501","80.1600","80.1600x001","80.1601","80.1602","80.1603","80.1604","80.1700x001","80.1701","80.1702","80.4101","80.4102","80.4201","80.4202","80.4501","80.4502","80.4601","80.4603","80.4701","80.4702","80.6x00x010","80.6x00x011","80.6x03","80.6x04","80.6x05","80.6x06","80.6x07","80.6x08","80.7100","80.7101","80.7200","80.7201","80.7500","80.7501","80.7600","80.7601","80.7701","80.8101","80.8102","80.8201","80.8202","80.8501","80.8600x009","80.8601","80.8602","80.8700x007","80.8701","80.8702","80.8900x001","80.8900x005","80.8901","80.9600","81.4401","81.4402","81.4403","84.1600"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IC4入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IC49_group(record):
      return 'IC49'

    return 'IC4'
  else:
    return ''

