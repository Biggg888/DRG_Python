from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCH_DRG

def group(record):
  adrg_zd=["A18.814+K77.0*","B17.900x002","B17.902","B18.106","B67.000x001+K77.0*","B67.800x001+K77.0*","C22.000","C22.001","C22.100","C22.900","C23.x00","C24.000x007","C24.002","C24.003","C25.000","C25.100","C25.200","C25.803","C25.900","C78.700","D13.400","D13.500x001","D13.701","D18.013","D37.706","I81.x00","K65.007","K70.300","K70.302+I98.3*","K70.303+I98.2*","K70.304+I98.2*","K71.601","K71.901","K72.000x004","K72.003","K72.100","K72.900x003+G94.3*","K74.300","K74.300x005+I98.2*","K74.300x008+I98.3*","K74.600x003","K74.602","K74.603","K74.604","K74.605","K74.607","K74.614","K74.615+I98.3*","K74.616+I98.2*","K74.617+I98.3*","K74.618+I98.3*","K74.619+I98.2*","K74.620+I98.2*","K75.000","K75.003","K75.400","K75.804","K76.806","K76.807","K76.814","K76.900x002","K76.901","K80.000x004","K80.002","K80.100x001","K80.101","K80.301","K80.302","K80.304","K80.501","K81.000","K81.002","K81.006","K81.900","K82.802","K83.005","K83.010","K83.109","K83.304","K85.101","K85.102","K85.800x003","K85.818","K85.900","K85.902","K86.100x004","K86.200","K86.300","K86.809","K86.810","K91.840","K92.800x010","K92.801","Q44.601","S36.102","S36.200x001","S36.201"]
  adrg_zd1=[]
  adrg_ss=["34.8102","38.0704","38.7x04","38.8602","38.8603","39.9003","39.9600x003","40.3x00x002","40.5908","41.4200x002","41.5x00","42.9100x002","44.9100x001","50.0x00x004","50.0x01","50.0x03","50.0x04","50.1200","50.2100","50.2301","50.2302","50.2905","50.2908","50.2909","50.6101","50.9200x001","50.9201","51.8200x002","51.8201","52.0100","52.0901","52.0902","52.0903","52.1200","52.2101","52.2201","52.4x00x004","52.4x03","52.4x06","52.9501","54.0x00x010","54.0x02","54.1100","54.1101","54.1900x010","54.1903","54.2100","54.5100x005","54.5101","54.5102","54.5901","54.5902","54.5903","54.6301","54.9100x002","54.9100x009","54.9101","88.4701","88.4702","88.4705"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合HJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCH_DRG.HJ11_group(record):
      return 'HJ11'

    if MDCH_DRG.HJ13_group(record):
      return 'HJ13'

    if MDCH_DRG.HJ15_group(record):
      return 'HJ15'

    return 'HJ1'
  else:
    return ''

