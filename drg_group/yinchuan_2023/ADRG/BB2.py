from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCB_DRG

def group(record):
  adrg_zd=["C70.000","C71.000","C71.003","C71.100","C71.200","C71.500","C71.600","C71.703","C71.800","C71.800x006","C71.801","C71.806","C71.808","C71.900","C71.900x002","C71.902","C72.800x001","C75.300","C79.300","C79.300x002","C79.300x011","C79.300x019","C79.303","C79.305","C79.306","D18.000x028","D18.002","D32.000","D32.000x004","D32.000x014","D32.000x021","D32.000x024","D32.000x028","D32.000x032","D32.000x036","D32.000x038","D32.001","D32.002","D32.003","D32.004","D32.005","D32.006","D32.007","D32.008","D32.010","D32.011","D32.012","D32.013","D32.014","D32.018","D32.019","D32.020","D32.900x002","D33.000","D33.004","D33.006","D33.007","D33.101","D33.102","D33.104","D33.200x001","D33.200x003","D33.202","D33.300","D33.305","D33.307","D33.308","D35.201","D35.300","D43.004","D43.007","D43.104","D44.401","G03.800x003","G06.001","G06.006","G06.203","G25.601","G40.202","G40.900","G50.000","G50.003","G51.002","G51.003","G51.301","G52.101","G81.100","G91.800x006","G91.802","G93.000x015","G93.001","G93.500x001","G93.501","G93.504","G93.814","G93.903","G96.001","G96.003","G97.800x009","I60.101","I60.201","I60.800x008","I60.801","I61.004","I61.100x001","I61.100x003","I61.100x004","I61.100x005","I61.100x006","I61.100x007","I61.100x008","I61.100x009","I61.100x010","I61.100x011","I61.100x013","I61.100x014","I61.101","I61.200x001","I61.400x001","I61.400x003","I61.500x002","I61.500x008","I61.600x001","I61.802","I61.900x004","I61.900x007","I61.902","I61.903","I62.000","I62.000x005","I62.001","I62.003","I62.101","I63.900","I63.902","I63.904","I63.905","I63.906","I67.100x032","I67.500","I67.803","Q07.000","Q27.800x025","R90.000","S06.200x011","S06.200x032","S06.200x081","S06.202","S06.204","S06.300x011","S06.300x081","S06.400","S06.401","S06.500","S06.500x002","S06.501","S06.502","S06.510","S06.600","S06.700x002","S06.700x003","S06.700x004","S06.700x007","S06.800x002","S06.802","S06.910","Z42.001"]
  adrg_zd1=[]
  adrg_ss=["01.0900x006","01.0900x008","01.0900x009","01.1800x002","01.2400x005","01.2400x009","01.2400x013","01.2402","01.2405","01.2408","01.2409","01.2411","01.2413","01.2414","01.3104","01.3105","01.3108","01.3900x009","01.3900x017","01.3902","01.3904","01.3905","01.3906","01.3909","01.3910","01.3911","01.5100x006","01.5100x007","01.5103","01.5104","01.5105","01.5106","01.5107","01.5900x030","01.5900x036","01.5900x037","01.5900x041","01.5900x043","01.5900x044","01.5900x048","01.5901","01.5902","01.5903","01.5904","01.5905","01.5907","01.5908","01.5909","01.5911","01.5913","01.5915","01.5917","01.5918","01.5922","01.5923","01.5924","01.5925","01.5928","01.5931","01.5932","01.5935","01.5940","01.6x00","02.0300x001","02.0503","02.0504","02.0600x003","02.1201","02.1202","02.1203","02.1206","02.1208","02.1209","04.0101","04.0401","04.0702","04.0710","04.0711","04.4100x003","04.4101","04.4203","04.4204","04.4209","07.5301","07.6200x007","07.6201"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合BB2入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCB_DRG.BB21_group(record):
      return 'BB21'

    if MDCB_DRG.BB23_group(record):
      return 'BB23'

    if MDCB_DRG.BB25_group(record):
      return 'BB25'

    return 'BB2'
  else:
    return ''

