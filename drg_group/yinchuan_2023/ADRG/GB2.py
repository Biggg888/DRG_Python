from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCG_DRG

def group(record):
  adrg_zd=["A09.902","C17.900","C18.000","C18.001","C18.100","C18.200","C18.300","C18.400","C18.500","C18.600","C18.700","C18.801","C18.802","C18.900","C19.x00","C20.x00","C26.800","C78.501","C78.504","C79.809","D01.000","D01.200","D12.000","D12.100","D12.500","D12.600","D12.800","D17.500x007","D37.402","D37.411","D37.501","K35.301","K50.002","K51.900","K52.903","K55.002","K55.004","K56.100","K56.201","K56.203","K56.400x001","K56.500x003","K56.601","K56.603","K56.604","K56.700","K56.701","K57.100x005","K57.102","K57.305","K60.301","K60.303","K61.001","K62.300","K62.800x010","K62.903","K63.101","K63.102","K63.103","K63.104","K63.105","K63.107","K63.108","K63.200","K63.203","K63.205","K63.210","K63.213","K63.500x084","K63.503","K63.810","K63.814","K63.816","K63.901","K65.000","K65.003","K91.300","K91.305","K91.404","K91.405","K91.820","K92.206","Q41.903","Q42.200x901","Q42.200x902","Q43.101","Q43.103","Q43.812","S36.404"]
  adrg_zd1=[]
  adrg_ss=["17.3101","17.3200x002","17.3300","17.3300x002","17.3400","17.3401","17.3500","17.3500x001","17.3600","17.3600x001","17.3900x002","17.3901","40.5908","40.5909","40.5911","40.5912","45.0001","45.0002","45.6100","45.7200x002","45.7200x004","45.7201","45.7300x003","45.7300x007","45.7301","45.7302","45.7304","45.7400x003","45.7401","45.7500","45.7500x001","45.7501","45.7600x008","45.7601","45.7900x002","45.7901","45.8100x001","45.8200","45.9300x012","45.9300x013","45.9300x014","45.9301","45.9302","45.9304","45.9305","45.9307","45.9400x004","45.9400x016","45.9401","45.9402","45.9403","45.9404","45.9405","45.9406","45.9500x001","45.9504","46.1000","46.1000x007","46.1100","46.1100x002","46.2000","46.2001","46.2301","46.5200x012","46.7300x005","46.7303","46.8700","48.4903","48.5100","48.5100x002","48.5200","48.5201","48.5900x001","48.6100x001","48.6200","48.6201","48.6301","48.6302","48.6900x002","48.6900x004","48.6900x007","48.6902","48.6903","48.6904","48.6905","48.6907","48.6909","48.6910","48.6911","70.7300"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合GB2入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCG_DRG.GB29_group(record):
      return 'GB29'

    return 'GB2'
  else:
    return ''

