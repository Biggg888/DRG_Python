from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCP_DRG

def group(record):
  adrg_zd=["A09.900x005","L01.006","P05.200","P05.900","P08.000","P10.200","P10.300","P10.901","P12.000x001","P12.801","P13.000","P15.901","P20.901","P21.000","P21.101","P21.102","P21.900","P21.900x002","P23.200","P23.300","P23.400","P23.600","P23.600x001","P23.600x003","P23.600x004","P23.800","P23.900","P24.001","P24.002","P24.101","P24.300","P24.900","P24.901","P25.100","P26.900","P27.100","P27.900","P28.200","P28.400","P28.500","P28.800x101","P28.800x903","P28.900","P29.000","P29.100","P29.301","P29.401","P35.100","P35.200","P36.301","P36.400","P36.800x002","P36.900","P36.901","P37.800x002","P38.x01","P39.101","P39.200","P39.300","P39.401","P39.801","P39.900","P52.000","P52.100","P52.300","P52.400","P52.500","P52.900","P54.100","P54.300x001","P54.500","P54.600","P55.002","P55.101","P55.102","P55.800x002","P55.900","P57.000","P57.800","P57.901","P58.200","P59.000","P59.202","P59.301","P59.801","P59.901","P59.902","P61.000","P61.001","P61.100","P61.200","P61.401","P61.500","P70.000","P70.100","P70.400x001","P70.401","P70.801","P70.900","P71.100","P71.100x001","P72.200x001","P72.800","P74.001","P74.002","P74.100","P74.403","P74.800x003","P74.802","P76.900","P77.x01","P78.000x005","P78.001","P78.002","P78.100x001","P78.200x001","P78.300x001","P78.300x002","P78.300x005","P78.800x004","P78.800x006","P78.800x007","P78.800x008","P78.800x012","P78.802","P78.807","P78.900","P78.901","P80.900","P81.001","P81.901","P81.902","P83.100","P83.301","P83.500","P83.500x003","P90.x00","P91.000x002","P91.600","P91.700","P91.800x001","P91.900","P91.900x001","P92.000","P92.001","P92.100x001","P92.300","P92.800x001","P92.800x003","P92.900","P94.200x001","P96.400","P96.800x904","P96.801","P96.804","P96.900x001","Q89.000","Q89.002"]
  adrg_zd1=[]
  adrg_ss=[]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ageDay!=None and record.ageDay<=28:
    message('符合PU1入组条件，匹配规则：主诊断匹配、新生儿')
    
    if MDCP_DRG.PU11_group(record):
      return 'PU11'

    if MDCP_DRG.PU13_group(record):
      return 'PU13'

    if MDCP_DRG.PU15_group(record):
      return 'PU15'

    return 'PU1'
  else:
    return ''

