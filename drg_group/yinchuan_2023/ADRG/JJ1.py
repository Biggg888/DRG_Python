from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCJ_DRG

def group(record):
  adrg_zd=["A18.403","A18.406","A18.412","B07.x04","C43.503","C43.600","C43.700x001","C43.707","C43.800","C43.900","C44.500","C44.502","C44.503","C44.504","C44.601","C44.606","C44.700","C44.702","C44.707","C44.900","C50.400","C50.900","C79.200x001","C79.204","D17.000x004","D17.100x001","D17.100x003","D17.101","D17.200x001","D17.200x002","D17.200x003","D17.200x004","D17.200x005","D17.300x001","D17.300x002","D17.300x004","D17.300x005","D17.500x010","D17.500x011","D17.900x001","D17.900x002","D18.000x010","D18.000x018","D18.000x849","D18.000x850","D18.000x851","D18.005","D18.006","D18.007","D18.008","D22.502","D22.507","D22.700","D22.701","D22.900","D22.900x002","D23.400x003","D23.501","D23.504","D23.506","D23.700x001","D23.900","D24.x02","D28.000x001","D36.716","D48.515","D48.601","I89.000x015","L02.100","L02.200","L02.200x004","L02.200x010","L02.201","L02.202","L02.203","L02.206","L02.300","L02.401","L02.402","L02.403","L02.800","L02.801","L02.803","L02.901","L02.902","L03.003","L03.004","L03.102","L03.107","L03.108","L03.109","L03.200","L03.300","L03.302","L03.800","L03.900","L05.000","L05.900","L08.800x005","L08.800x006","L08.801","L08.803","L08.805","L08.900","L08.901","L08.903","L08.904","L08.905","L08.906","L08.907","L08.908","L08.910","L08.911","L30.901","L30.902","L40.500","L57.000","L60.000","L72.000","L72.101","L72.102","L72.103","L72.104","L72.105","L72.106","L72.900x001","L72.900x002","L72.901","L72.902","L72.903","L72.904","L73.200","L73.803","L75.000","L81.400","L82.x00","L85.900x001","L89.300","L89.301","L89.900","L90.500x009","L90.500x029","L90.500x030","L90.500x036","L90.500x038","L90.500x048","L90.500x049","L90.500x050","L90.500x061","L90.500x062","L90.502","L91.001","L91.800","L91.801","L92.000","L92.801","L92.901","L92.903","L97.x00","L98.400","L98.800","L98.801","N61.x03","N61.x06","N62.x02","N64.100","Q83.100x001","R22.002","R22.005","R22.006","R22.100x001","R22.200x002","R22.202","R22.203","R22.204","R22.206","R22.207","R22.300x002","R22.302","R22.400x002","R22.400x003","R22.902","R22.903","S31.001","S60.202","S60.800x043","S70.901","S80.000","S80.100x002","S80.101","S80.800x041","S80.800x042","S90.100","S90.800x032","T01.301","T11.101","T13.000x041","T14.001","T14.003","T14.101","T85.400"]
  adrg_zd1=[]
  adrg_ss=["18.2100x006","18.2101","18.2900x003","18.2900x009","18.2900x016","18.2901","18.2907","20.5100x002","21.3201","27.0x01","27.0x08","27.0x10","27.4301","34.0102","34.4x01","34.7101","38.6000x011","38.6302","40.2100","40.2300","40.2400","40.2910","40.3x00x002","54.0x00x001","54.0x00x002","54.0x00x004","54.0x00x013","54.0x00x022","54.3x00x004","54.3x00x027","54.3x01","54.3x03","54.4x00x012","54.4x00x047","61.3x03","61.4102","71.0900x001","71.0900x004","71.0900x006","71.0902","71.0904","71.3x00x001","71.3x01","71.3x04","71.7101","71.7102","86.0100x002","86.0100x003","86.0301","86.0302","86.0400x011","86.0401","86.0402","86.0500x007","86.0502","86.0900x002","86.0902","86.2101","86.2102","86.2200x011","86.2201","86.2202","86.2300x001","86.2300x002","86.2300x003","86.2300x005","86.2301","86.2400x001","86.2701","86.3x01","86.3x02","86.3x03","86.3x04","86.3x06","86.3x07","86.3x10x038","86.3x12","86.3x13","86.3x15","86.3x16","86.4x01","86.4x02","86.4x03","86.5900x006","86.5901","86.5902","86.8401","86.8600x001","86.9900","98.2600x001","98.2900x001"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合JJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCJ_DRG.JJ11_group(record):
      return 'JJ11'

    if MDCJ_DRG.JJ13_group(record):
      return 'JJ13'

    if MDCJ_DRG.JJ15_group(record):
      return 'JJ15'

    return 'JJ1'
  else:
    return ''

