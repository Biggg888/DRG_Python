from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCH_DRG

def group(record):
  adrg_zd=["B00.803+K77.0*","C22.000","C22.001","C22.100","C22.101","C22.900","C23.x00","C24.000","C24.000x007","C24.001","C24.002","C24.003","C24.100","C24.101","C24.900","C25.000","C25.900","C77.203","C78.700","C78.807","C78.808","D13.400","D13.600","D18.013","D37.601","D37.705","D37.706","I72.809","I74.803","I81.x00","K72.000x004","K72.003","K74.100","K74.300x006+I98.3*","K74.300x007+I98.2*","K74.300x008+I98.3*","K74.302+I98.3*","K74.602","K74.605","K74.607","K74.608","K74.614","K74.615+I98.3*","K74.616+I98.2*","K74.617+I98.3*","K74.618+I98.3*","K74.619+I98.2*","K75.000","K75.003","K75.400","K76.401","K76.804","K76.806","K76.807","K76.811","K76.814","K80.000x002","K80.000x004","K80.001","K80.002","K80.100x001","K80.101","K80.300x005","K80.301","K80.302","K80.303","K80.304","K80.305","K80.401","K80.402","K80.403","K80.404","K80.500x002","K80.501","K80.503","K80.504","K81.000","K81.002","K81.900","K83.000","K83.000x007","K83.001","K83.005","K83.100","K83.105","K83.108","K83.109","K83.502","K83.805","K83.807","K85.000","K85.001","K85.002","K85.100","K85.101","K85.102","K85.202","K85.818","K85.900","K85.900x003","K85.902","K86.100x002","K86.100x004","K86.103","K86.200","K86.809","K86.901","K91.806","K92.800x006","Q44.504","Q44.601","Q45.300x902","R93.203","R93.204","R93.302","S36.102"]
  adrg_zd1=[]
  adrg_ss=["38.9900x501","39.7900x033","39.7903","42.3307","42.3308","42.3309","44.4400x001","50.2401","50.2402","50.2403","50.2404","50.9101","50.9102","50.9103","50.9300","50.9401","50.9402","51.0101","51.0102","51.0103","51.8400x001","51.8402","51.8403","51.8404","51.8500x002","51.8501","51.8503","51.8600x002","51.8700x001","51.8700x003","51.8700x004","51.9601","51.9800x001","51.9800x005","51.9800x008","51.9800x009","51.9800x010","51.9800x012","51.9800x013","51.9800x015","51.9800x016","51.9803","51.9804","51.9805","51.9806","51.9808","52.9201","52.9300","52.9300x002","52.9400","52.9400x002","52.9700","52.9800x001","97.5506","97.5601"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合HL1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCH_DRG.HL11_group(record):
      return 'HL11'

    if MDCH_DRG.HL13_group(record):
      return 'HL13'

    if MDCH_DRG.HL15_group(record):
      return 'HL15'

    return 'HL1'
  else:
    return ''

