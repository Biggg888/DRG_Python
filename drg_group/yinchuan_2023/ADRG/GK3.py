from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCG_DRG

def group(record):
  adrg_zd=["A09.004","A09.901","B49.x12","C16.301","C16.500","C16.801","C18.200","C18.400","C18.500","C18.600","C18.700","C18.900","C18.900x001","C18.901","C19.x00","C20.x00","D01.000","D01.200","D12.000","D12.000x002","D12.001","D12.200","D12.300","D12.301","D12.400","D12.500","D12.600","D12.601","D12.602","D12.603","D12.800","D13.000","D17.500","D37.401","D37.402","D37.708","K21.001","K22.600x001","K22.700x001","K22.801","K25.000x002","K25.400x001","K25.700","K25.900x001","K26.400x003","K26.401","K26.900x001","K26.900x002","K27.900x002","K29.000","K29.001","K29.400","K29.500","K29.501","K29.603","K29.701","K29.801","K30.x00","K31.100x002","K31.701","K31.703","K31.904","K38.100","K51.200x001","K51.900","K51.901","K51.902","K52.000x001","K52.907","K52.910","K55.000x005","K55.902","K56.100","K56.500x003","K56.700","K56.700x003","K56.701","K57.303","K58.100","K58.801","K59.000","K59.003","K59.900x001","K60.000","K61.001","K62.100","K62.100x002","K62.600x002","K62.800x009","K62.811","K62.903","K63.105","K63.301","K63.305","K63.500","K63.500x084","K63.501","K63.502","K63.503","K63.504","K63.813","K63.816","K63.902","K64.802","K64.809","K64.811","K64.901","K92.206","K92.208","K92.209","K92.210","K92.901","R10.400x002","R93.300x003","T18.500x004"]
  adrg_zd1=[]
  adrg_ss=["45.4200x003","45.4201","45.4300x008","45.4301","45.4302","45.4303","45.4304","45.4305","45.4306","45.4307","46.8500x009","46.8600","46.9601","46.9602","48.3600x001","48.3600x002","48.3600x004","49.3101","98.0401"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合GK3入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCG_DRG.GK39_group(record):
      return 'GK39'

    return 'GK3'
  else:
    return ''

