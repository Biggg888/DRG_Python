from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["A18.006+M49.0*","A23.901+M49.1*","C49.100x001","C49.100x002","C49.200x001","C49.200x002","C49.200x006","C49.202","C49.501","C49.601","C76.502","C79.500x032","D16.103","D16.200x005","D16.304","D21.100","D21.100x002","D21.100x003","D21.102","D21.200","D21.200x006","D21.202","D21.303","D21.401","D21.500x005","D21.501","D21.900x003","D21.900x007","D21.900x013","D36.700x029","D36.700x032","D36.714","D36.715","D36.718","D48.001","D48.903+M90.7*","I00.x01","L40.501+M07.3*","L87.100","M00.900","M00.900x021","M00.900x061","M05.200x092","M05.308","M05.800","M05.900","M06.000","M06.100","M06.200","M06.300","M06.900","M06.906","M06.907","M06.909","M10.002","M10.003","M10.900","M10.900x093","M10.903","M13.000","M13.100","M13.800x001","M13.900","M15.000","M15.400","M15.900","M15.902","M16.900","M17.000","M17.101","M17.900x002","M17.900x003","M17.900x004","M19.900","M19.901","M19.902","M19.905","M20.100x002","M21.003","M21.302","M21.505","M21.601","M23.205","M25.301","M25.411","M25.416","M25.505","M25.804","M25.808","M25.900x031","M25.900x061","M32.900","M35.101","M35.200","M35.300","M35.901","M40.101","M43.006","M43.600","M43.601","M45.x00","M47.101+G99.2*","M47.201","M47.801","M47.802","M48.002","M48.005","M48.901","M48.902","M48.903","M50.201","M51.101+G55.1*","M51.103+G55.1*","M51.105+G55.1*","M51.201","M51.202","M51.204","M51.205","M51.303","M51.800x004","M53.101","M62.405","M62.800x096","M62.817","M65.004","M65.900x093","M65.902","M65.906","M65.907","M67.100x041","M67.400","M67.400x031","M67.401","M67.402","M67.800x092","M70.200","M70.301","M70.400","M70.500x002","M71.000","M71.106","M71.107","M71.200","M71.200x001","M71.301","M71.302","M71.306","M71.307","M71.310","M71.909","M72.600","M72.605","M72.906","M75.000","M75.001","M75.400","M76.600","M79.500","M79.506","M79.509","M79.600x051","M79.800x096","M79.808","M80.900","M81.000","M81.900","M85.300","M85.600x052","M86.608","M86.907","M86.916","M87.002","M87.800x051","M87.800x091","M89.813","M89.913","M89.927","M95.401","Q66.000","Q66.800x016","Q66.805","Q67.600","Q68.001","Q68.002","Q68.102","S22.300","S22.400","S22.400x011","S22.400x021","S22.400x041","S22.500","S32.000x002","S32.801","S42.000","S42.100","S43.100","S46.002","S46.101","S46.201","S52.811","S56.700x001","S59.900","S61.701","S61.702","S61.901","S62.600x002","S62.611","S62.710","S62.802","S66.100x001","S66.100x003","S66.100x006","S66.100x007","S66.100x009","S66.200x001","S66.200x003","S66.200x007","S66.200x009","S66.300x001","S66.300x007","S66.300x009","S66.500x001","S66.600x001","S66.900x001","S68.001","S68.100x001","S68.200x001","S68.201","S69.700","S82.211","S82.510","S82.800x082","S83.600x002","S83.602","S86.001","S86.300x001","S86.300x004","S86.300x006","S89.700","S91.301","S92.000","S92.110","S92.310","S92.500x001","S93.200x002","S93.200x004","S93.400x002","S93.400x021","S96.100x001","S96.101","S96.102","S96.200x001","S96.700x001","S96.801","S96.900x002","T11.900","T13.001","T13.502","T13.900","T14.601","T84.807","T87.602"]
  adrg_zd1=[]
  adrg_ss=["34.7400x005","34.7400x010","34.7402","40.2900x019","77.1002","77.1003","78.1103","78.4102","78.5100x016","78.5102","79.1901","79.3900x049","79.3903","79.5900","79.6000","80.5900x001","80.9901","80.9902","80.9903","81.9101","81.9201","81.9202","83.0900x003","83.0901","83.0903","83.0904","83.1900x010","83.1900x017","83.1900x018","83.1900x020","83.1901","83.1903","83.2900x001","83.2900x002","83.2900x003","83.3100","83.3100x001","83.3101","83.3900x001","83.3900x016","83.3900x017","83.3901","83.3902","83.3903","83.3904","83.4501","83.8400","83.8401","83.8800x001","83.8800x010","83.8800x012","83.8800x014","83.8800x015","83.8800x016","83.8800x017","83.8800x018","83.8801","83.8803","83.9800x001","84.2900","84.3x00","84.5501"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IJ11_group(record):
      return 'IJ11'

    if MDCI_DRG.IJ13_group(record):
      return 'IJ13'

    if MDCI_DRG.IJ15_group(record):
      return 'IJ15'

    return 'IJ1'
  else:
    return ''

