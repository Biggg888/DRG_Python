from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCE_DRG

def group(record):
  adrg_zd=["A15.000x001","A15.000x002","A15.000x010","A15.000x012","A15.000x014","A15.000x016","A15.000x018","A15.000x020","A15.000x022","A15.000x026","A15.002","A15.007","A15.100x001","A15.100x002","A15.100x003","A15.100x005","A15.100x007","A15.100x010","A15.107","A15.207","A15.307","A15.500x003","A15.500x010","A15.508","A16.006","A16.007","A16.008","A16.009","A16.010","A16.017","A16.018","A16.027","A16.036","A16.037","A16.107","A16.108","A16.200x002","A16.200x015","A16.201","A16.206","A16.207","A16.402","A16.406","A16.500x004","A16.500x010","A16.900x002","A19.001","A19.801","A19.802","B37.101+J17.2*","B44.000x001+J99.8*","B44.101+J99.8*","B44.102+J17.2*","B45.000x002+J99.8*","C34.000","C34.000x002","C34.000x003","C34.001","C34.100x003","C34.100x004","C34.201","C34.300x003","C34.300x004","C34.802","C34.900x001","C34.900x004","C34.900x005","C34.901","C38.300","C77.103","C78.000","C78.201","D38.101","D86.000","I26.900x001","I26.900x010","I26.900x015","I88.900x008","J12.900","J13.x00","J15.000x002","J15.100","J15.101","J15.500","J15.600x005","J15.700","J15.800x001","J15.900","J15.902","J15.903","J18.000","J18.100","J18.802","J18.803","J18.900","J18.903","J20.900","J20.901","J20.902","J22.x00","J40.x00","J42.x00","J42.x00x004","J44.000","J44.100","J44.800x001","J44.801","J44.900","J45.004","J45.005","J45.900x001","J45.900x021","J45.900x041","J45.903","J46.x00x003","J47.x00","J47.x01","J47.x03","J62.803","J67.900","J69.001","J84.100x008","J84.101","J84.104","J84.108","J84.803","J84.900","J85.100","J85.200","J86.017","J94.801","J94.804","J95.808","J96.000","J96.900x001","J96.900x002","J98.003","J98.005","J98.010","J98.101","J98.102","J98.201","J98.400x016","J98.400x019","J98.405","J98.410","J98.413","J98.414","J98.700","J98.800x001","M05.102+J99.0*","M35.904+J99.1*","R04.200","R05.x00","R05.x01","R06.000","R91.x00x001","R91.x03","R91.x04","S27.501","T17.500","T27.300"]
  adrg_zd1=[]
  adrg_ss=["31.1x00x005","31.4100","31.4200x001","31.4200x003","31.4201","31.4202","31.4400x001","33.2200x003","33.2301","33.2302"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合EJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCE_DRG.EJ11_group(record):
      return 'EJ11'

    if MDCE_DRG.EJ13_group(record):
      return 'EJ13'

    if MDCE_DRG.EJ15_group(record):
      return 'EJ15'

    return 'EJ1'
  else:
    return ''

