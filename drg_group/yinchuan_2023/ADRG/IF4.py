from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["A18.002+M01.1*","C40.202","D16.200x005","D16.202","D16.203","D16.300x003","D16.300x004","D16.303","D16.304","D21.200x006","D21.202","D21.900x013","D36.715","D48.001","D48.020","M05.800","M06.800x071","M10.002","M10.900x093","M10.903","M12.500x071","M13.100","M17.000","M17.101","M19.101","M19.900x094","M19.900x096","M20.002","M20.100x002","M20.400x001","M20.501","M21.002","M21.100x072","M21.105","M21.400","M21.908","M25.301","M43.006","M48.005","M60.007","M67.400","M76.602","M76.800x072","M77.300","M77.400","M77.503","M77.800x002","M79.907","M84.000","M84.000x062","M84.000x071","M84.100","M84.100x061","M84.100x062","M84.100x071","M84.401","M85.000x062","M85.001","M85.500","M85.600x062","M85.600x072","M86.400","M86.600x061","M86.608","M86.900","M86.900x073","M86.912","M86.913","M86.914","M86.915","M86.916","M87.000","M87.200x073","M87.204","M87.800x091","M87.900x071","M89.810","M89.813","M89.818","M89.900x091","M89.911","M89.926","M89.927","M96.900","Q66.000","Q66.600","Q66.800x007","Q66.800x008","Q66.800x013","Q66.803","Q74.101","Q74.800x403","Q78.400","Q78.500","S52.500x001","S62.802","S82.000","S82.010","S82.100x011","S82.100x012","S82.100x082","S82.100x085","S82.100x087","S82.100x088","S82.100x089","S82.101","S82.110","S82.200x011","S82.200x081","S82.201","S82.202","S82.203","S82.211","S82.212","S82.300x011","S82.300x081","S82.300x082","S82.300x083","S82.301","S82.310","S82.311","S82.400x001","S82.400x014","S82.400x091","S82.500","S82.500x001","S82.501","S82.510","S82.600","S82.600x001","S82.601","S82.610","S82.700","S82.800x081","S82.800x082","S82.801","S82.802","S82.803","S82.811","S83.000","S83.500x022","S83.500x042","S83.600x002","S83.700x003","S91.300x811","S91.301","S92.000","S92.202","S92.203","S92.300","S92.300x001","S92.300x003","S92.310","S92.400","S92.500x001","S92.510","S92.700","S92.710","S92.910","S93.000","S93.103","S93.300x031","S93.400x002","S98.300","T02.300x001","T02.800x001","T12.x10","T13.900","T79.601","T84.300x001","T84.604","Z44.800x002","Z47.001"]
  adrg_zd1=[]
  adrg_ss=["77.0701","77.0900x004","77.0903","77.1700x001","77.1701","77.1803","77.1903","77.2800x001","77.2800x004","77.2800x005","77.2801","77.2900x005","77.5100","77.5301","77.5700x001","77.6701","77.6702","77.6802","77.6900x007","77.6900x020","77.6900x047","77.6903","77.7701","77.8700x003","77.8701","77.8801","77.8900x026","77.8900x027","77.8900x028","77.9903","78.0700x004","78.0700x006","78.0701","78.0702","78.0802","78.0900x001","78.0900x014","78.1701","78.1702","78.2902","78.3701","78.4701","78.4702","78.4802","78.4900x006","78.4903","78.5600x002","78.5700x003","78.5700x005","78.5700x006","78.5700x007","78.5700x008","78.5700x009","78.5700x011","78.5700x012","78.5700x013","78.5701","78.5800x006","78.5800x007","78.5802","78.5900x020","78.5900x034","78.5903","78.9701","79.0601","79.0603","79.0604","79.0702","79.0801","79.1600x004","79.1600x006","79.1600x008","79.1600x009","79.1600x010","79.1600x012","79.1600x013","79.1600x014","79.1601","79.1603","79.1700x005","79.1700x006","79.1700x009","79.1700x010","79.1700x013","79.1702","79.1800x002","79.1900x005","79.2601","79.2602","79.2603","79.2700x004","79.2801","79.3600x008","79.3600x009","79.3600x010","79.3600x011","79.3600x012","79.3600x013","79.3600x014","79.3600x015","79.3600x016","79.3600x017","79.3600x018","79.3600x019","79.3601","79.3602","79.3603","79.3604","79.3700x010","79.3700x012","79.3700x013","79.3700x014","79.3700x015","79.3700x016","79.3700x017","79.3700x018","79.3700x019","79.3700x020","79.3700x021","79.3701","79.3702","79.3800x002","79.3800x003","79.3800x004","79.3800x005","79.3900x001","79.3900x002","79.3900x052","79.5601","79.6702","79.6800","84.1200","84.1501","84.4600"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IF4入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IF49_group(record):
      return 'IF49'

    return 'IF4'
  else:
    return ''

