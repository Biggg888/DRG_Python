from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCO_DRG

def group(record):
  adrg_zd=["O00.100","O00.101","O00.102","O00.104","O00.107","O00.109","O00.201","O00.801","O00.803","O00.807","O00.809","O00.900","O01.001","O01.101","O01.102","O01.901","O02.001","O02.100","O03.001","O03.002","O03.100x001","O03.101","O03.102","O03.300","O03.400x001","O03.503","O03.603","O03.802","O03.900x002","O03.901","O04.000x003","O04.001","O04.100x002","O04.101","O04.300","O04.400","O04.401","O04.900x001","O04.901","O04.902","O04.905","O05.100","O05.400","O06.000","O06.100","O06.301","O06.400","O08.004","O08.102","O08.802","O08.803","O10.001","O11.x01","O13.x00","O13.x01","O14.000x001","O14.100x002","O14.900","O21.100","O21.100x006","O23.500x001","O23.501","O24.400","O31.800x003","O32.102","O34.005","O34.100x001","O34.200x002","O34.301","O34.400x011","O34.404","O34.503","O34.800","O34.800x005","O34.800x006","O34.800x014","O34.800x018","O34.800x021","O34.802","O34.807","O35.003","O35.008","O35.101","O35.102","O35.200x004","O35.800x001","O35.800x003","O35.801","O35.810","O35.817","O35.819","O35.823","O36.302","O36.401","O36.503","O41.104","O42.000x001","O42.000x002","O42.100x012","O42.900","O43.001","O43.200x001","O43.200x002","O45.900","O47.100","O47.900x002","O60.001","O61.900","O71.101","O72.002","O72.003","O72.100","O72.101","O72.201","O72.202","O73.001","O73.101","O73.102","O85.x00","O86.201","O86.402","O86.802","O90.800x008","O90.801","O99.000x031","O99.215","O99.400x004","O99.510","O99.600x001","O99.800x321","O99.800x412","Z34.900x001"]
  adrg_zd1=[]
  adrg_ss=["54.1202","54.6101","65.0105","65.2501","65.2503","65.6300","65.7400","65.7900x008","65.7901","65.7905","65.9500","65.9902","66.2201","66.2901","66.2903","66.4x02","66.5102","66.6100x007","66.6100x012","66.6102","66.6104","66.6200x004","66.6201","66.8x01","66.8x02","66.9502","67.5100","68.2101","68.2204","68.2206","68.2302","68.3103","68.3104","68.4100","69.0100x002","69.0101","69.0200x003","69.0201","69.0202","69.1900x022","69.1907","69.5101","69.5102","69.5103","69.5201","69.5202","69.5901","69.7x00","69.9600","71.0900x001","71.0902","72.1x00","73.0100","73.0900x001","73.1x01","73.1x02","73.4x00x004","73.4x01","73.4x02","73.4x03","75.3700","75.9900x004","75.9901","75.9902"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合OJ1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCO_DRG.OJ19_group(record):
      return 'OJ19'

    return 'OJ1'
  else:
    return ''

