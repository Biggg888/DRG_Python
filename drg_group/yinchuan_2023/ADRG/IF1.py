from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["C40.002","C49.100x001","C76.400","C79.500x021","C79.507","D16.002","D16.701","D16.702","D48.018","D48.903+M90.7*","M10.903","M21.001","M21.102","M24.812","M71.310","M84.000x031","M84.000x032","M84.000x041","M84.000x051","M84.100x011","M84.100x021","M84.100x031","M85.000x031","M85.000x082","M85.600x021","M86.901","M86.903","M86.904","M86.905","M89.817","M89.818","M89.918","Q78.600","S22.000x003","S42.000","S42.000x021","S42.000x031","S42.000x091","S42.100","S42.100x011","S42.100x021","S42.100x031","S42.200x001","S42.200x011","S42.200x041","S42.200x092","S42.202","S42.203","S42.300","S42.301","S42.311","S42.400x001","S42.400x041","S42.400x043","S42.400x092","S42.400x093","S42.401","S42.402","S42.403","S42.404","S42.410","S43.000","S52.000x002","S52.000x021","S52.001","S52.002","S52.100x001","S52.100x012","S52.101","S52.102","S52.200","S52.200x011","S52.201","S52.300","S52.300x011","S52.310","S52.400x001","S52.410","S52.500x001","S52.500x003","S52.500x011","S52.501","S52.502","S52.510","S52.600x001","S52.600x002","S52.700","S52.701","S52.801","S52.811","S52.812","S53.000","S53.100","S59.700","S61.901","S62.301","S63.000x083","S69.700","S72.000","S72.101","S72.300","S72.400x012","T02.800x001","T02.900","Z47.001"]
  adrg_zd1=[]
  adrg_ss=["77.1200x001","77.2200x001","77.2200x003","77.2300x001","77.2300x002","77.2302","77.6102","77.6103","77.6104","77.6201","77.6301","77.6302","77.8103","77.8200","78.0200x001","78.0200x002","78.0300x004","78.0300x005","78.0301","78.0302","78.1301","78.2302","78.4301","78.4302","78.5200x005","78.5200x006","78.5201","78.5300x002","78.5300x006","78.5300x009","78.5301","78.5302","78.9301","79.0100x001","79.0201","79.0202","79.0901","79.1100x002","79.1100x003","79.1100x004","79.1100x005","79.1200x003","79.1200x004","79.1200x005","79.1200x006","79.1200x007","79.1200x008","79.1200x009","79.1200x010","79.1201","79.1202","79.1900x006","79.1900x008","79.1902","79.2101","79.2201","79.2202","79.2901","79.3100x004","79.3100x005","79.3100x006","79.3100x007","79.3100x008","79.3101","79.3200x001","79.3200x002","79.3200x009","79.3200x010","79.3200x011","79.3200x012","79.3200x013","79.3200x014","79.3201","79.3202","79.3900x028","79.3900x040","79.3900x041","79.3900x042","79.3900x044","79.3900x051","79.3902","79.3904","79.4201","79.5100","79.6201","84.0500","84.0701","84.2301","84.4101"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IF1入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IF11_group(record):
      return 'IF11'

    if MDCI_DRG.IF13_group(record):
      return 'IF13'

    if MDCI_DRG.IF15_group(record):
      return 'IF15'

    return 'IF1'
  else:
    return ''

