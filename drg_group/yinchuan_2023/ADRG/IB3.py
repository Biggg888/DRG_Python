from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCI_DRG

def group(record):
  adrg_zd=["A18.006+M49.0*","A18.007+M49.0*","A18.009+M49.0*","A23.901+M49.1*","A23.902+M01.3*","C41.201","C79.500x001","C79.500x006","C79.500x025","C79.500x031","C79.500x032","C79.509","D16.600x004","D16.600x005","D16.701","D21.503","D48.013","D48.903+M90.7*","M06.100","M06.900","M06.909","M17.000","M24.204","M24.907","M24.908","M30.300","M32.900","M33.101","M35.900x006+G63.5*","M40.100x051","M40.200x041","M40.201","M41.101","M41.800","M41.900","M41.900x061","M41.901","M43.005","M43.006","M43.009","M43.100x061","M45.x00","M46.300x061","M46.403","M46.500x092","M47.002+G99.2*","M47.101+G99.2*","M47.201","M47.204","M47.801","M47.802","M47.900","M48.002","M48.003","M48.004","M48.005","M48.006","M48.502","M48.503","M48.801","M48.804","M48.806","M48.808","M48.901","M48.902","M48.903","M50.000+G99.2*","M50.001+G99.2*","M50.101+G55.1*","M50.200x001","M50.201","M51.101+G55.1*","M51.105+G55.1*","M51.200x004","M51.202","M51.204","M51.303","M51.400","M51.800x004","M51.802","M53.202","M53.203","M53.205","M53.206","M53.207","M54.300","M60.008","M79.800x081","M80.000","M80.800","M80.801","M80.900","M81.000","M81.800x091","M81.900","M84.100x081","M84.200","M84.401","M87.002","M89.818","M96.802","M99.300x003","M99.500x003","Q67.501","S12.000x002","S12.100x002","S12.200x031","S12.200x051","S12.900x001","S13.103","S22.000x003","S22.000x011","S22.000x021","S22.000x031","S22.000x041","S22.000x051","S22.000x061","S22.100","S32.000x002","S32.000x011","S32.000x021","S32.000x031","S32.000x041","S32.000x051","S32.702","S33.100x051","S46.002","T02.100x001","T84.202","T91.103","T91.104","Z45.800x002","Z45.800x011","Z47.000x002","Z47.001"]
  adrg_zd1=[]
  adrg_ss=["03.0900x003","03.0900x004","03.0900x005","03.0900x006","03.0900x007","03.0900x009","03.0900x010","03.0900x016","03.0900x021","03.0900x023","03.0900x026","03.0900x027","03.0901","03.0903","03.0904","03.0905","03.0909","03.0910","03.0911","03.0912","03.0913","03.0914","03.0915","03.1x00x001","03.3101","03.3202","03.4x03","03.4x05","03.4x07","03.5301","03.5302","03.5304","03.5305","03.5900x005","03.6x01","03.6x02","03.9000x001","03.9100x004","03.9101","03.9102","03.9200x001","54.4x00x047","77.0904","77.2900x004","77.6900x032","77.6900x039","77.6900x055","77.6904","77.8900x013","77.8905","78.0900x008","78.0900x009","78.0900x010","78.0900x011","78.0900x015","78.0900x018","78.0900x019","78.0904","78.1900x004","78.4904","78.5900x022","78.5900x037","78.5904","79.8900x006","79.8900x007","80.0900x001","80.5100x008","80.5100x011","80.5100x013","80.5100x023","80.5100x024","80.5100x025","80.5100x026","80.5100x027","80.5100x028","80.5100x029","80.5100x030","80.5100x032","80.5100x033","80.5100x034","80.5100x035","80.5100x036","80.5100x037","80.5100x038","80.5100x039","80.5101","80.5102","80.5103","80.5105","80.5107","80.5108","80.5109","80.5110","80.5111","80.5200","81.6500","81.6600x001","81.6600x002","81.6600x003","81.6601","84.5900x002","84.8100","84.8201","84.8205"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合IB3入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCI_DRG.IB39_group(record):
      return 'IB39'

    return 'IB3'
  else:
    return ''

