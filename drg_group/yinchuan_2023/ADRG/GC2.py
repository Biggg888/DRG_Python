from drg_group.yinchuan_2023.Base import message,intersect,SS_VALID
from drg_group.yinchuan_2023.DRG import MDCG_DRG

def group(record):
  adrg_zd=["C16.301","C16.803","C16.900","C17.200","C17.900","C18.300","C18.500","C18.700","C18.900","C19.x00","C20.x00","C48.201","C78.400","C78.403","D12.300","D12.500","D13.301","D37.200x002","D37.201","D37.204","D37.206","D37.401","K25.900x001","K31.904","K31.905","K35.200","K35.201","K35.300","K35.800x001","K40.306","K40.307","K41.302","K43.500","K46.000x002","K46.100x001","K46.101","K46.900x002","K50.002","K55.002","K55.004","K55.007","K55.009","K55.010","K56.100","K56.101","K56.200","K56.200x003","K56.201","K56.203","K56.401","K56.500x003","K56.600x008","K56.603","K56.700","K56.700x003","K57.000","K57.001","K57.002","K57.100x005","K57.105","K57.106","K57.301","K57.305","K59.900x001","K63.103","K63.108","K63.200","K63.207","K63.210","K63.213","K63.500","K63.501","K63.504","K63.813","K63.816","K65.000","K65.003","K65.800x001","K91.300","K91.305","K91.800x602","K91.804","K91.820","K92.800x007","Q40.200x010","Q41.203","Q41.903","Q42.803","Q43.000","Q43.003","Q43.004","Q43.301","Q43.800x017","S36.404","T18.300","T18.300x003","T18.400"]
  adrg_zd1=[]
  adrg_ss=["45.0201","45.0202","45.0203","45.0302","45.0303","45.2600","45.3300x006","45.3300x009","45.3301","45.3302","45.3303","45.3304","45.4100x002","45.4100x003","45.4100x004","45.4100x007","45.4101","45.4102","45.4104","45.4105","45.4107","45.4108","45.4900x003","45.4900x005","45.6200x001","45.6201","45.6204","45.6205","45.6206","45.6207","45.6208","45.9100x006","45.9100x008","45.9101","45.9102","45.9103","46.1300","46.1301","46.2100","46.3900x002","46.3900x007","46.3902","46.3904","46.4100","46.4201","46.4301","46.5100x002","46.5100x006","46.5200x006","46.5202","46.6200x003","46.7400x004","46.7404","46.7405","46.7501","46.7506","46.7601","46.7603","46.8001","46.8002","46.8101","46.8102","46.8201","46.8202"]
  adrg_ss1=[]
  adrg_ss2=[]
  dept_list=[]
  if True and record.zdList[0] in adrg_zd and record.ssList and record.ssList[0] in adrg_ss and record.ssList and intersect(record.ssList,adrg_ss):
    message('符合GC2入组条件，匹配规则：主诊断匹配、主手术匹配、某一手术匹配')
    
    if MDCG_DRG.GC21_group(record):
      return 'GC21'

    if MDCG_DRG.GC23_group(record):
      return 'GC23'

    if MDCG_DRG.GC25_group(record):
      return 'GC25'

    return 'GC2'
  else:
    return ''

