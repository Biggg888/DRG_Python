from drg_group.taizhou_2022.Base import message,intersect,SS_VALID
from drg_group.taizhou_2022.ADRG import EB1,EB2,EC1,EC2,ED1,EJ1,ER1,ER2,ER3,ES1,ES2,ES3,ET1,ET2,EU1,EV1,EW1,EX1,EX2,EZ1

def group(record):
  mdc_zd=["J86.014","J62.800x003","D14.300x001","J15.600x005","J98.800x016","J69.000x002","A15.500x026","J21.901","S27.311","J45.900x002","A16.034","A22.102+J17.0*","A19.000x010","R09.200","J86.000","A15.810","B39.100","A15.204","J12.800","J95.811","J18.000x001","S27.811","C46.701","J90.x02","A02.201+J17.0*","J92.900x002","J18.800x004","T17.803","J84.800x005","J98.601","A16.207","A16.503","B41.000","J11.000x001","I88.107","M05.103+J99.0*","I89.800x018","J82.x01","J86.019","J21.000","Z03.800x001","J67.700x002","B40.200","J98.008","I88.106","C34.300x004","J80.x01","A15.500x025","R06.400","R93.805","A19.000x005","Q32.300","C79.807","J18.800x012","J98.600x001","R94.204","A16.029","R04.200","J18.001","C45.000","J86.020","C78.201","C34.900x008","E32.001","J66.800","J92.000","C77.100x004","B42.000+J99.8*","J69.000","J98.500x007","J94.800x004","J44.000","A15.606","A16.010","E32.800x001","J62.000x002","J63.800x015","A16.200x002","C34.900x004","J98.400x019","A16.036","A16.403","J98.000x012","J63.001","J43.101","J93.800x001","A15.812","J45.900","A16.037","J44.900x005","J70.400","I89.000x016","J12.300","B40.100","A15.100x010","J43.900","S27.312","A16.107","A16.500x008","J90.x00x003","J95.808","J18.002","A16.003","D18.000x814","R84.400","D14.302","I89.003","J98.100","A15.500x029","A16.103","C78.000","J98.003","D38.100x003","A15.106","R84.000","A43.000x001+J99.8*","J42.x01","A19.803","J63.800","J98.404","R06.805","E85.412+J99.8*","J67.900","A15.202","A15.604","C78.000x003","C38.400x003","J95.810","J98.602","J63.000","A15.901","J63.000x002","J60.x00x003","J98.400x008","J85.100","S28.100","B45.000","R94.200","J41.000","A16.023","A15.500x022","A15.205","J98.007","J98.800x007","Q33.400","A15.500x014","J62.803","R06.301","Q32.102","A15.307","S28.000","S24.200","D02.400","J09.x00","D14.400","A19.802","B44.101+J99.8*","D02.100","D14.200","D38.101","J62.800x005","J18.801","J85.200","Q32.400x002","J82.x00x002","J43.901","S27.600","J18.902","Q33.003","C78.306","R94.201","A15.007","A15.100x005","D02.200x002","J93.900","B06.800","J68.800","Q33.301","J60.x00","J45.100x002","J63.500","I89.000x029","C34.801","D38.300x002","J95.802","A15.004","J67.600","M33.901+J99.1*","J90.x00","A15.403","D38.100x002","A15.505","J66.000","A19.000x019","A15.501","A15.000x026","A15.805","C34.900x005","J12.000","J84.109","C34.000","I89.800x017","J63.800x026","B37.100","J15.402","J18.900","A16.301","J43.000x003","J84.805","A15.607","J60.x00x004","D86.200","J64.x00","J45.900x031","A15.500x003","R91.x04","A15.400x001","S27.210","J84.801","I26.900x007","J80.x00","J95.800x016","A16.007","Q85.904","I89.000x028","J90.x00x004","J84.104","I26.901","J21.801","J45.000x001","J68.301","R09.800x092","Q32.402","J67.200x003","R06.803","J63.802","A15.500x011","A15.603","A06.502+J17.3*","A16.001","A16.700x001","J20.300","J44.807","Q89.800x910","S27.700","T84.200x004","J67.700x001","J98.800x001","J18.800x001","T86.800x011","J46.x00x009","Q79.102","J39.803","B37.803","G47.300x034","A19.001","D15.200","J98.413","J39.810","A15.304","J84.800x006","J43.100","J15.300","J96.900x001","A15.000x002","I26.900x018","J70.900","D38.601","J67.800x002","A15.602","J98.102","E89.802","J61.x00x003","D36.706","R91.x00x005","A16.204","A16.900x003","J84.102","J98.101","E32.800x005","A15.206","A01.000x005+J17.0*","C34.102","I89.800x023","J98.500x008","D17.700x023","R84.904","A16.102","J67.800x005","I26.900x011","B48.500+J17.2*","J68.101","J63.800x025","C78.200","A15.100x002","B37.800x083","A15.402","S29.800","B38.100","D14.301","I26.900x012","J40.x00","J63.301","Q85.908","A16.006","I28.800x010","J85.002","J84.100x006","R06.000x002","R09.201","A16.803","J63.803","J86.013","J95.800x010","C38.401","Q85.900x015","J42.x00x004","C76.100","C77.105","J15.800x001","R91.x00x001","B49.x14+J99.8*","J62.804","I89.804","Q79.101","D17.700x019","J21.100","J63.300x002","J94.800x003","A16.201","D48.709","I26.900x006","J12.900","J46.x01","J86.017","J98.402","B44.000x001+J99.8*","D36.700x013","A15.102","J98.004","I89.800x016","J94.804","C34.802","A16.210","C38.400","D38.105","J62.000x003","A15.500x010","Q33.000","A19.000x001","J63.400","A16.016","J98.401","J98.400x001","J96.000","C45.701","S27.000","J65.x00","J20.600","J20.800","C78.100","A16.030","A15.306","J21.900x002","J60.x01","J98.001","A15.000x010","A15.305","I89.800x002","A16.400x010","J98.200","J98.506","J94.101","A16.002","R06.800x005","S29.900","A15.301","D15.900","A16.406","J86.015","S27.808","J68.201","A16.500x009","A16.008","I26.900x005","J15.500","J41.800","J44.900x002","J67.800x004","R09.800x094","A15.609","J86.012","A15.100x008","A16.900x023","J39.806","J45.006","J15.600x006","J86.004","B39.200x001+J17.2*","J86.000x012","Q34.900","D36.700x008","B77.801+J17.3*","J86.902","J94.801","R05.x00","A15.703","J63.000x003","J68.400","R06.000x003","T27.500x001","M05.102+J99.0*","J39.808","E85.404","S27.410","A15.203","J39.807","Q34.000","J98.802","J84.800x004","S27.801","R84.100","A15.808","D19.000","M32.103+J99.1*","A16.402","Q79.103","I26.900x016","A15.000x016","A15.803","R09.801","A16.807","J86.003","J43.001","A19.000x016","J98.500x001","A15.000x028","A15.408","A16.026","J84.110","A15.802","J94.805","J98.800x006","M05.101+J99.0*","J81.x00","B49.x13","S27.301","R04.900","J86.005","T27.300","A37.901+J17.0*","J15.700","A16.020","S27.400","J63.800x017","C34.900x006","J81.x00x002","J47.x02","J63.100","J42.x00x003","B58.300+J17.3*","J84.002","Q85.901","A15.303","A19.000x004","J98.400x005","J15.600x003","J96.900x003","D38.102","J90.x00x005","D15.200x001","J84.100x008","T81.400x009","A15.503","J98.800x014","J15.400","B65.902+J99.8*","R91.x01","A15.000x001","E32.801","J92.901","A16.303","J44.900","J46.x00x008","A15.811","J98.405","J14.x00","B01.200+J17.1*","C49.300x001","D86.000","A16.200x015","U07.100x002","A15.504","B25.000+J17.1*","J98.000x011","J47.x01","J20.200","J45.000","J67.800x003","A15.900","C76.100x003","D38.301","J62.800x004","J82.x00x004","A16.031","J84.103","A15.500x023","J98.000x009","M33.103+J99.1*","A15.104","R84.700","U07.100x003","J21.900","J96.100","A19.000x014","B66.401+J99.8*","S27.900","J20.000","J93.003","S27.802","J86.001","C34.000x003","C38.100","I26.900x013","E32.000x003","A15.105","A15.300x001","A16.500x001","J94.200","J68.900","J98.415","R84.800","S27.510","J45.902","I26.900x002","A15.500x004","A15.000x022","A16.000x002","J63.800x003","J98.412","S27.810","J47.x03","A19.000x006","T17.500","J98.801","I26.900x008","J98.700","C79.810","J45.900x012","J90.x01","J98.005","J63.800x001","A16.009","J67.500","J98.418","T27.700","Q79.000","D15.200x002","J70.101","J98.501","J98.400x012","J95.900","J15.601","Q33.200","A15.001","J18.200","J63.800x010","J86.016","D18.000x857","A15.200x001","C34.902","J98.800x009","B39.000","B49.x00x011","A15.608","A15.500x020","S27.812","J98.411","J62.801","J95.804","A16.505","J45.000x003","J61.x00x001","B39.100x001+J17.2*","J66.100","J70.001","A15.601","D38.104","J63.800x009","S27.401","S27.500","J86.002","J95.800x009","S27.303","C34.800x001","C34.900x001","C34.800","I26.900x001","J39.802","R09.100x002","J67.300","A15.500x001","J63.801","Q34.100","D48.710","M31.302+J99.1*","J86.008","C34.901","A16.004","A16.900x002","C37.x00","A15.701","J84.900","J20.900","R06.000","A15.000x014","J44.900x004","Q33.500","A15.804","J69.000x004","C34.100x004","B38.000x001+J17.2*","R09.101","J63.800x024","J94.806","J18.000","Q33.002","J98.403","J18.901","C79.800x809","A16.500x010","J15.101","A16.300x007","A16.700x002","J46.x00x003","J18.800x002","J62.800x006","D15.701","J10.000","A16.200x007","A15.813","B46.000x001+J99.8*","A16.401","C34.300x003","J63.800x021","J93.100x002","R09.300","A16.806","A16.028","J62.802","A19.000x015","J67.400x002","A16.011","A37.900","J45.100","J98.201","A16.100x001","A15.100x007","A15.405","A16.014","J20.700","A15.107","A37.900x004","T17.400","A16.013","B38.100x001+J17.2*","J60.x00x005","A06.501+J99.8*","B44.102+J17.2*","A21.201+J17.0*","D38.200x001","J86.903","R93.804","D36.717","J98.507","A15.201","A15.406","J47.x00","J66.200","A15.509","A16.101","J98.503","I89.800x021","A16.203","J46.x00x006","C34.201","A15.100x009","A15.500x012","J45.007","A15.100x004","J15.901","J63.800x018","S27.302","A16.202","A19.000x018","T27.600x001","A15.702","B45.000x002+J99.8*","J94.201","J18.800x006","J63.800x013","M34.801+J99.1*","A19.000x017","A15.814","A16.200x012","C78.304","C38.800","J61.x00x002","J62.800x007","J98.400x016","S27.710","A16.038","I97.800x018","J98.505","R09.100","A15.207","M34.800x001+J99.1*","I88.900x008","C34.100x003","A16.802","A16.501","J45.900x023","S27.110","J18.802","A16.504","M05.100+J99.0*","A15.806","C49.302","C34.001","D17.400x001","J94.900x001","A19.000","R84.600","J39.804","J63.800x019","J45.901","C38.200","J85.300","A15.500x017","A16.304","C34.803","A15.407","B48.501+J17.2*","A15.100x001","A16.305","A15.500x028","A36.201","J15.000x002","J70.800","Q33.600","A15.002","R06.200","J45.005","Q33.800x002","I26.900x009","J67.200","J20.100","J20.400","J95.401","J44.806","J86.000x013","J84.800x008","A16.300x003","A16.302","J86.007","C34.101","J09.x02","D21.302","J98.009","S27.313","J98.504","R06.804","R93.801","A15.409","A15.500x002","R09.800x095","J43.900x001","T85.700x804","E32.100","J10.001","D48.700x019","E83.104+J99.8*","J45.800","J45.900x001","J63.800x011","A15.809","J67.800x001","A19.000x009","M31.304+J99.1*","J43.800x001","D17.400x005","J67.400","C45.702","D18.011","J44.900x003","J68.000x001","A16.200x013","J98.408","J98.414","M31.300x002","A16.025","B37.101+J17.2*","J16.800x001","J43.903","J86.009","J90.x00x002","A19.000x007","D38.201","J84.000x003","J45.002","A37.800x001","J46.x00x002","J67.200x002","J98.417","S27.300x012","A15.508","A19.000x013","S27.610","J84.108","J85.000x002","J63.300x003","J15.200","A15.302","J95.800x012","A16.015","A15.800x001","E85.407","J84.803","J70.300","A16.405","I89.807","C34.800x002","C78.003","J45.900x013","J86.011","J45.900x011","M35.904+J99.1*","S29.700","J15.000","S27.806","J82.x00x005","A15.100x003","R84.200","I89.800x007","R06.300","J20.901","D02.201","J63.800x020","R84.903","A16.108","Q32.200","B38.200x001+J17.2*","J39.805","J45.003","J98.901","U07.100x001","A16.024","D18.100x026","I00.x00x007+J17.8*","J95.300","J63.800x016","C45.700","J46.x00x010","J98.407","C39.900x001","R84.300","J98.000x013","D15.700","C34.000x002","T79.800x007","B65.907+I52.1*","J09.x01","J82.x00x001","J44.805","J94.901","J98.011","Q89.209","J45.900x041","A37.100","J15.800x002","J98.400x013","T17.501","D38.600x001","J63.000x001","J15.903","J84.800x003","Q33.900","R04.802","J62.800x002","S25.401","D38.300x003","D38.401","J18.903","R06.801","S27.805","J98.800x004","J42.x00x006","A16.400x005","A16.000x001","A19.000x020","J45.903","I26.902","A15.103","J10.100x005","J84.100x007","A16.800x003","R84.500","A16.012","A16.200x014","J68.001","A16.035","J15.900","C39.800","B38.200","J18.803","D38.103","J15.902","A15.401","J63.800x014","A54.806+J17.0*","J13.x00","S27.803","J94.800x010","A15.507","A19.000x012","S27.200","A16.106","B39.000x001+J17.2*","E32.800x004","M35.002+J99.1*","R91.x03","B48.502+J17.2*","A15.500x013","D38.300x001","T17.801","T17.804","C34.301","J63.300x001","J18.000x002","J20.902","J67.100","J84.800x007","A15.100x006","A15.003","A37.000","S27.804","A15.000x003","J42.x00x005","S27.010","J98.800x003","J98.800x018","J86.006","R06.806","R06.100","J43.200","D17.400x002","A16.205","J15.100","A15.605","J40.x00x002","J43.902","J44.802","S27.807","Q32.400x005","J44.100","C78.001","T17.802","A16.018","J68.000x002","T86.803","J20.500","J44.800x001","J63.800x005","C34.800x003","R09.800x093","B40.000","J11.100x005","B05.200+J17.1*","J98.006","A16.022","D38.100x001","E32.000","C79.800x829","A15.000x020","J15.602","J45.004","A16.032","Q33.100","R06.600","S27.910","C38.300","S27.501","A15.101","A19.000x003","J63.800x012","J62.001","A15.404","J15.600x002","C77.101","A16.900x001","J98.410","A16.801","A16.500x004","I26.900x003","J84.105","S27.800x013","J95.800x021","A06.500x002+J99.8*","A16.800x002","J43.904","J98.010","A37.900x003","J12.100","A06.500+J99.8*","J86.901","J45.100x003","A15.000x012","J69.001","A15.801","A15.807","J96.900x002","M33.201+J99.1*","A15.500x027","J44.803","R04.800x004","R59.009","U07.000","A16.109","A15.500x018","D17.400x004","Q33.800x001","T85.608","A16.027","J98.502","A52.704+J99.8*","J84.802","A16.021","C33.x00","A16.104","J67.000","A16.019","J16.000","U04.900","A15.506","B39.200","J41.100","J84.804","R04.800x002","R09.800x091","A15.100x011","T17.901","J98.416","A16.005","A15.500x024","B33.400x001+J17.1*","S27.100","J95.100","J93.100x001","A15.200x002","A19.000x008","A16.033","J98.002","A16.804","D15.000","J70.200x002","C77.100","D17.400x003","J10.000x001","J42.x00","J63.200","J84.101","A19.000x011","B38.000","A16.017","D38.400x001","J40.x01","J69.800x001","J84.001","J63.800x023","J95.200","J43.000","R05.x01","J95.800x004","J63.201","Q32.400x004","A15.500x019","J86.000x006","R09.000","J12.200","J60.x00x002","E84.001","J62.800x008","J61.x01","A15.500x021","J69.100x001","C77.103","J85.001","Q32.401","A15.000x024","A19.000x002","J94.802","A15.500x016","E32.900","D48.115","D18.000x800","A15.005","R06.802","T17.900","J46.x02","C77.104","J69.101","A16.300x002","A15.000x018","J98.409","I26.900x017","J68.002","J98.300","I26.900x010","J18.100","B67.100x001+J99.8*","C77.102","A15.502","E85.400x005","J44.801","C78.002","I89.000x027","J63.800x022","J95.801","J70.200","E32.802","A16.206","R05.x02","I26.900x015","A16.400x011","M33.001+J99.1*","J42.x00x001","C49.300x003","J39.801","A19.801","D18.100x025","J98.508","A16.105","J62.000x001","T27.200x001","A15.006","C79.800x838","B06.801+J17.1*","J86.018","J86.010","A15.500x015","E32.002","J94.807","R94.202","D18.100x015","S27.310","J45.900x021","J22.x00","J67.600x001","A16.805"]
  dept_list=[]
  if not (True and record.zdList[0] in mdc_zd):
    return ''
  
  message('符合MDCE入组条件，匹配规则：主诊断匹配')

  result=EB1.group(record)
  if result:
    return result
  result=EB2.group(record)
  if result:
    return result
  result=EC1.group(record)
  if result:
    return result
  result=EC2.group(record)
  if result:
    return result
  result=ED1.group(record)
  if result:
    return result
  result=EJ1.group(record)
  if result:
    return result

  if False and record.ssList and intersect(SS_VALID,record.ssList):
    message('符合EQY入组条件，存在有效手术操作：'+','.join(set(record.ssList).intersection(SS_VALID)))
    return 'EQY'

  result=ER1.group(record)
  if result:
    return result

  result=ER2.group(record)
  if result:
    return result

  result=ER3.group(record)
  if result:
    return result

  result=ES1.group(record)
  if result:
    return result

  result=ES2.group(record)
  if result:
    return result

  result=ES3.group(record)
  if result:
    return result

  result=ET1.group(record)
  if result:
    return result

  result=ET2.group(record)
  if result:
    return result

  result=EU1.group(record)
  if result:
    return result

  result=EV1.group(record)
  if result:
    return result

  result=EW1.group(record)
  if result:
    return result

  result=EX1.group(record)
  if result:
    return result

  result=EX2.group(record)
  if result:
    return result

  result=EZ1.group(record)
  if result:
    return result

  message('不符合MDCE的ADRG入组条件')

