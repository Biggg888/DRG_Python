from drg_group.taizhou_2022.Base import message,intersect,SS_VALID
from drg_group.taizhou_2022.ADRG import LA1,LA2,LB1,LB2,LC1,LD1,LE1,LF1,LJ1,LL1,LR1,LS1,LT1,LU1,LV1,LW1,LX1,LZ1

def group(record):
  mdc_zd=["Q64.402","N32.800x012","E14.200x091+N08.3*","C67.900","E85.411+N29.8*","M31.102+N08.5*","E10.200x015+N08.3*","Q62.104","E10.200x214+N08.3*","N06.900","C68.800x003","N32.814","M31.002+N08.5*","R94.803","N21.900","N25.806","N36.803","N04.300x003","E10.200x025+N08.3*","C67.700","I13.100x001","C64.x00x003","D09.000","N03.500x003","T83.000x001","N28.804","R32.x01","Q60.400x001","C65.x00","N14.400","N20.901","N28.003","E14.200x211+N08.3*","N23.x00","N07.700","N30.800x004","N39.900","E10.200x024+N08.3*","N35.000x001","I12.900x006","N39.400","N34.000","N17.901","C79.000x001","N34.300","N28.900x017","N10.x00","Q62.300x903","N03.901","N04.300x001","R93.400x002","M32.101+N08.5*","N05.600","E10.200x028+N08.3*","S37.010","N00.801","T86.105","R82.900x002","N13.100x001","N28.816","T19.100","S37.000x031","N03.900x002","M31.703+N08.5*","C66.x00x003","S37.100","N28.832","Q64.200","N04.900","T83.101","N02.301","N36.005","E11.201+N08.3*","T86.103","N30.807","N28.812","N07.400","N34.205","Q63.800x902","N32.200","D30.300","S37.813","N36.806","N18.100","N28.823","N28.833","N03.400","N07.800","N01.900","N28.901","N28.806","Q64.700x601","T79.500","D09.100x001","N32.000","T86.811","S37.200x024","N20.200x001","D09.103","E14.200x023+N08.3*","Q60.600","N06.400","N07.100","N11.100","N30.806","R82.901","T83.100x004","N36.901","T83.802","E72.006+N29.8*","T83.804","Q64.600","C68.804","Q62.200","N99.806","N39.200","S37.101","N07.000","D21.506","N02.302","N28.817","Q62.300x902","R35.x00x003","N31.200x002","N36.804","N02.101","N02.802","Q62.100x902","Q64.502","N13.502","N99.500","N13.301","E11.200x025+N08.3*","E10.200x014+N08.3*","E14.200x015+N08.3*","I12.900x009","N28.900x004","N14.102","N28.830","N03.800x004","R30.100x001","N35.100x001","Q62.100","T83.100x002","E10.200x211+N08.3*","N02.203","N04.200x001","N06.200","N36.200","N31.200x006","Q61.403","C79.101","E83.100x008+N16.3*","Q62.202","Q64.708","N12.x00","T79.500x002","N00.500","E10.201+N08.3*","Q51.701","C67.000","N36.003","N28.002","C67.300","D30.100","N30.300","N39.800","E14.200x031+N29.8*","N28.814","N11.800x003","N17.900","N31.800","T83.501","E85.403","N07.200","N13.501","S37.300x082","N15.102","N34.001","D17.700x016","N17.200","Q61.404","Q62.301","N17.900x002","N25.804","E11.200x011+N08.3*","N17.900x004","Q62.300x905","N32.002","D41.201","N20.100","D30.900","E14.200x025+N08.3*","N13.506","Q61.800","R93.402","C68.900","T83.800x001","N13.201","N30.400","N05.000x004","E14.200x027+N08.3*","N36.805","N17.100","N19.x03","C76.303","Q60.300","T19.800x001","D30.302","N32.805","N15.801","Q63.001","R80.x02","R39.100x001","I12.900x002","N13.600x004","N31.203","Z46.601","N25.900","C65.x02","N39.404","N11.802","D41.401","E14.200x013+N08.3*","N03.300x001","E11.200x029+N08.3*","N06.600","N17.900x003","N18.200","N28.828","N00.600","N07.300","E11.200x091+N08.3*","N39.402","T86.100x006","N13.801","E10.200x091+N08.3*","N03.100","N13.504","E11.200x031+N29.8*","C68.802","E14.200x011+N08.3*","M10.001+N16.8*","N04.400x001","Q62.300x301","I12.900x008","N25.802","Q61.400","R93.404","S37.000x016","E14.400x380+G99.0*","Q87.808","N07.600","N36.807","N04.800x002","Q63.801","Q62.300x901","A02.205+N16.0*","E10.200x023+N08.3*","M31.701+N08.5*","N13.503","I12.900x003","Q62.400x001","E13.201+N08.3*","Z46.800x001","N04.801","N17.002","N20.001","N32.201","Q64.301","Q64.501","N34.002","C48.001","N03.900x006","Q62.601","T28.800","N13.600x002","T28.300","N20.900","N30.802","Q64.707","Q64.400x902","R35.x00x001","C67.600","N06.300","N32.807","S37.000x013","N32.812","N36.302","C67.100","N20.900x001","S37.302","N11.901","N17.101","N32.803","N36.000","N07.500","N36.000x007","C95.900x017+N16.1*","Q64.706","T86.100x001","N03.502","Q61.901","N12.x03","N02.900x002","R33.x00","R82.000","N19.x01","T83.500x003","N00.900x008","E10.200x215+N08.3*","E11.200x012+N08.3*","N32.800x019","Q64.303","Q60.200","N32.300","D41.901","T83.500","Q64.700x801","R82.500x006","N03.900","N12.x02","N03.601","R82.500x005","N28.837","N17.001","D09.101","N13.604","T86.100x008","Q60.500","C67.800","R80.x00x003","E10.200x027+N08.3*","T81.800x011","C95.900x007+N16.1*","Q64.700x902","C67.900x002","D41.400x004","Z46.602","E11.200x030+N08.3*","N28.821","N03.900x005","N34.201","Q62.300x101","E10.200x026+N08.3*","N02.002","R93.400x001","R35.x00","N28.822","N13.601","N15.900x003","N25.805","N28.835","N32.810","E11.200x014+N08.3*","D30.200","N36.002","Q87.800x903","R39.801","M35.007+N16.4*","Q62.800","Q60.400","N25.004","N04.102","S37.002","C64.x00x004","Q61.401","N00.400","N05.000x001","E10.200x213+N08.3*","D41.100x001","R82.700","N35.000","E10.200x016+N08.3*","N02.201","T19.801","N32.203","C68.803","N99.808","N32.802","N01.900x001","S37.000x012","N05.101","D41.900x001","N26.x01","N28.820","N18.904","D41.300x001","Q61.900","M31.100","E11.200x214+N08.3*","Q62.400x002","C67.500","E14.200x012+N08.3*","R31.x00","S37.300x004","N04.101","N05.900x007","N14.301","R94.802","S37.211","N05.803","Q63.302","E14.200x214+N08.3*","E10.200x212+N08.3*","N13.300x005","N06.100","N39.300","N04.700","R80.x01","Q64.100","N36.808","I86.201","S37.303","N31.000x001","N02.102","Q61.300","N32.100","Z49.201","N03.503","S37.300x005","Q64.304","N32.800x014","N13.302","Z52.400","N02.801","R94.402","N04.502","Q62.103","Q85.900x029","N99.000","R82.500x004","T28.800x001","T86.104","N03.000","N01.600x001","C68.100","N25.803","E10.200x031+N29.8*","N01.500x001","N30.000","N04.902","C79.103","C67.501","N32.400","E10.200x017+N08.3*","N32.808","N99.100x005","M32.102+N16.4*","C68.000","N99.805","N36.301","E11.200x028+N08.3*","E11.200x213+N08.3*","N02.900x001","N20.000x001","C68.805","N28.808","E11.400x380+G99.0*","T86.100x002","N32.800x003","R30.100","T86.102","N27.000","C65.x01","N39.100","N28.900x013","N03.200x001","Q42.200x201","R82.200","C76.301","N03.800x001","N35.900","Z49.101","T83.001","T83.003","N00.902","N30.902","N30.809","N28.819","N05.900x006","N00.802","Q64.400x301","Q63.900","Q64.200x021","T83.102","R82.300","N32.813","N13.600x001","D41.001","E14.200x213+N08.3*","N21.100","D41.301","N31.200x007","Q61.100","R94.401","Q62.400","S37.000","T19.000","N36.201","Q62.000","T83.002","N28.836","E14.200x014+N08.3*","N05.501","R30.900x001","N28.839","N28.809","D41.101","N13.602","N14.101","Q64.700x701","S37.003","S37.200x011","Q64.700x201","E14.200x024+N08.3*","Q60.000","Q62.602","N01.200x001","N34.200x003","N03.900x004","N04.601","N13.400","N00.700","N28.004","N02.401","N10.x01","D18.000x819","N25.800x006","N00.200","N30.803","N39.800x001","Q62.700x001","N28.801","R82.500x003","S37.200x022","Z46.603","Z49.000x002","N15.900x002","D30.000","N19.x02","T83.100x003","C90.004+N16.1*","Q62.700x201","Q63.201","Z46.800x002","N05.900x003","N32.103","R39.101","N15.000","I12.904","N34.202","N02.502","Q64.703","E11.200x092+N08.3*","N15.900x004","Q63.002","Q64.701","S37.111","S37.004","N03.900x003","N12.x01","N21.000","N34.204","N03.801","D30.400","Q61.500","N01.300x001","N28.005","N39.401","S37.000x015","S37.300x083","M10.005+N22.8*","Q63.301","N19.x00","N11.900x001","R94.400","N03.501","N15.901","Q64.900","N17.800","T86.106","E13.200x521+N08.3*","N20.000x002","N26.x02","N28.813","N06.700","Z49.000x004","E14.200x026+N08.3*","N28.902","T86.100x007","N32.900x002","Q64.000","D30.301","T83.200","N07.900x001","Q64.705","N05.201","N32.800x009","E10.200x012+N08.3*","N28.827","N06.500","E10.200x013+N08.3*","N00.000","R30.000x002","T83.801","N32.301","N99.100","N13.603","N01.900x002","N03.900x007","Q62.100x802","N36.802","N36.809","N00.901","R34.x01","E11.200x212+N08.3*","Q60.501","N13.204","N34.203","N39.000","T83.100","N00.100x001","R34.x02","D41.400x001","N28.800x001","S37.300x011","C79.102","T86.100x003","T83.800","A40.901+N08.0*","N30.901","N28.824","N30.810","N21.001","N18.500","N36.100","Q60.100","N01.000","N36.004","E14.200x017+N08.3*","I12.900x001","N01.800","N02.900","Q64.302","E10.200x011+N08.3*","Q63.200","N18.900x011","N99.800x006","R93.401","R80.x00","N05.900","N32.811","N32.815","D41.200x001","E10.200x030+N08.3*","N17.200x002","Q85.900x013","N15.101","N34.100","N34.200x004","N03.800x003","E11.200x211+N08.3*","N28.802","D18.000x811","E11.200x015+N08.3*","N13.203","R39.200x001","C79.001","N99.001","C67.400","T86.107","N02.701","Q27.305","N02.001","N36.300","N18.901","N00.900","S37.000x032","S37.200x081","N14.000","S37.300x081","E14.400x381+N33.8*","N01.900x003","Q63.102","Q63.800x101","N28.838","C79.100x002","R36.x01","S37.011","R93.405","N30.808","Q63.000","N30.900","N01.100x002","N28.900x026","E11.200x017+N08.3*","R82.900x003","E14.200x212+N08.3*","N35.800","D09.102","N28.834","N31.901","S37.200","N25.001","Q62.600","Q64.704","Q64.100x091","D89.101+N08.2*","N05.701","R30.000","N11.800x002","N17.000","R32.x00","R93.400x003","N11.801","N31.202","N05.900x002","N27.900","D09.104","E72.007","T19.900","N00.900x006","N13.000","N34.102","N39.403","N25.100","N28.100","N11.900","E10.200x092+N08.3*","N28.829","N36.001","S37.000x022","N05.900x009","N39.300x002","C90.005+N08.1*","Q64.800x001","R82.902","N05.801","Q62.700x101","E11.200x027+N08.3*","Q62.201","N06.001","E11.200x023+N08.3*","N28.825","N28.810","E14.200x029+N08.3*","D41.000x001","T83.500x002","Z49.000","N28.900x010","N13.600","B65.002+N22.0*","E10.200x029+N08.3*","N17.200x003","E11.200x024+N08.3*","Q63.101","Q63.103","S37.814","E14.200x030+N08.3*","Z46.600x001","C66.x00","N00.301","Z45.800x007","N30.100","N04.901","R39.000","N13.901","N21.800","Q62.500","Q64.403","M31.003+N08.5*","N13.500x010","C64.x00x001","T81.800x014","N28.811","Q62.300x904","S37.300x031","N32.202","Q64.700x904","N04.903","N32.101","N28.101","Q64.200x001","T83.100x001","I12.000x001","N28.818","N18.300","N31.200x003","N13.701","Q85.903","R82.800","N30.805","N27.100","Q61.200","Q64.700x901","N31.200x001","N31.100x001","S37.300","N28.803","D18.000x806","C68.801","Q61.000","N32.801","I12.900x005","S37.300x021","R82.500x007","N30.801","N99.100x003","N11.000x001","N99.800x011","R82.600x001","T83.004","N32.204","N18.501","N30.804","C66.x00x002","N99.803","R79.802","N32.102","D30.701","N00.900x009","C68.800","E14.200x215+N08.3*","Q63.203","Q64.401","S37.001","Q61.801","N28.826","Q64.702","E11.400x381+N33.8*","N04.001","M31.305+N08.5*","E11.200x026+N08.3*","E12.200","N01.700x001","N10.x02","N32.901","R39.200","R93.403","N00.900x002","S37.200x023","N32.104","S37.000x023","N30.201","N11.900x003","N20.000x003","N20.002","N99.101","A41.902+N08.0*","N28.831","N18.400","Q62.700","N04.501","N26.x00","N32.804","E14.200x021+N08.3*","Q62.101","N34.000x005","D41.700","N28.001","N32.800x008","E66.902+N08.4*","S37.310","N34.101","N28.815","N13.202","N34.200x006","D69.005+N08.2*","N02.800x003","N28.805","N20.000","N28.807","E11.200x215+N08.3*","N18.902","S37.301","E11.200x013+N08.3*","N05.301","N05.000x003","N02.600","N32.806","N05.802","M35.006+N16.4*","C67.200","E85.002","N35.901","N05.400","N14.201","S37.201","E14.200x092+N08.3*","E14.200x016+N08.3*","N39.001","E14.200x028+N08.3*","Q61.402","T83.103","N02.702","N32.001","R39.100x002","N06.800","E11.200x016+N08.3*","N31.201","N32.809","T86.100x005","N03.700","N00.800x001","N01.400x001","N39.405","N28.102","N13.605"]
  dept_list=[]
  if not (True and record.zdList[0] in mdc_zd):
    return ''
  
  message('符合MDCL入组条件，匹配规则：主诊断匹配')

  result=LA1.group(record)
  if result:
    return result
  result=LA2.group(record)
  if result:
    return result
  result=LB1.group(record)
  if result:
    return result
  result=LB2.group(record)
  if result:
    return result
  result=LC1.group(record)
  if result:
    return result
  result=LD1.group(record)
  if result:
    return result
  result=LE1.group(record)
  if result:
    return result
  result=LF1.group(record)
  if result:
    return result
  result=LJ1.group(record)
  if result:
    return result
  result=LL1.group(record)
  if result:
    return result

  if False and record.ssList and intersect(SS_VALID,record.ssList):
    message('符合LQY入组条件，存在有效手术操作：'+','.join(set(record.ssList).intersection(SS_VALID)))
    return 'LQY'

  result=LR1.group(record)
  if result:
    return result

  result=LS1.group(record)
  if result:
    return result

  result=LT1.group(record)
  if result:
    return result

  result=LU1.group(record)
  if result:
    return result

  result=LV1.group(record)
  if result:
    return result

  result=LW1.group(record)
  if result:
    return result

  result=LX1.group(record)
  if result:
    return result

  result=LZ1.group(record)
  if result:
    return result

  message('不符合MDCL的ADRG入组条件')

